<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKRIP - –°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å</title>
    <style>
        /* ========== –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        :root {
            --primary: #4361ee;
            --primary-dark: #3a0ca3;
            --secondary: #f72585;
            --success: #4cc9f0;
            --warning: #f8961e;
            --danger: #ef233c;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --gray: #6c757d;
            --vk-light: #e5ebf1;
            --gradient: linear-gradient(145deg, var(--primary), var(--primary-dark));
            --gradient-accent: linear-gradient(145deg, var(--primary), var(--secondary));
            --shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 4px 20px rgba(0, 0, 0, 0.15);
        }

        body {
            background: var(--vk-light);
            min-height: 100vh;
        }

        /* ========== –°–ö–†–û–õ–õ–ë–ê–† ========== */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* ========== –ê–ù–ò–ú–ê–¶–ò–ò ========== */
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* ========== –°–¢–†–ê–ù–ò–¶–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò ========== */
        .auth-page {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .auth-container {
            background: white;
            border-radius: 20px;
            padding: 50px;
            width: 100%;
            max-width: 480px;
            box-shadow: var(--shadow-hover);
            animation: slideIn 0.5s;
        }

        .auth-logo {
            text-align: center;
            font-size: 64px;
            font-weight: 900;
            margin-bottom: 30px;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .auth-tabs {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--vk-light);
            padding-bottom: 15px;
        }

        .auth-tab {
            font-size: 20px;
            font-weight: 600;
            color: var(--gray);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .auth-tab.active {
            color: var(--primary);
        }

        .auth-tab.active::after {
            content: '';
            position: absolute;
            bottom: -17px;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--primary);
            border-radius: 3px;
        }

        .auth-form input {
            width: 100%;
            padding: 16px 20px;
            margin-bottom: 16px;
            border: 2px solid var(--vk-light);
            border-radius: 12px;
            font-size: 15px;
            transition: all 0.3s;
        }

        .auth-form input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(67, 97, 238, 0.1);
        }

        .auth-form input.error {
            border-color: var(--danger);
            animation: pulse 0.5s;
        }

        .auth-btn {
            width: 100%;
            padding: 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px 0;
        }

        .auth-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .admin-link {
            text-align: center;
            color: var(--primary);
            cursor: pointer;
            font-weight: 600;
            padding: 15px;
            border-radius: 12px;
            transition: all 0.3s;
        }

        .admin-link:hover {
            background: var(--vk-light);
        }

        /* ========== –û–°–ù–û–í–ù–ê–Ø –°–û–¶–°–ï–¢–¨ ========== */
        .social-page {
            display: none;
        }

        .social-page.active {
            display: block;
        }

        .header {
            background: white;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo {
            font-size: 28px;
            font-weight: 900;
            color: var(--primary);
            cursor: pointer;
        }

        .search {
            position: relative;
            width: 400px;
        }

        .search input {
            width: 100%;
            padding: 12px 20px;
            border: none;
            background: var(--vk-light);
            border-radius: 30px;
            font-size: 15px;
        }

        .search input:focus {
            outline: 2px solid var(--primary);
        }

        .search-results {
            position: absolute;
            top: 50px;
            left: 0;
            right: 0;
            background: white;
            border-radius: 15px;
            box-shadow: var(--shadow-hover);
            max-height: 400px;
            overflow-y: auto;
            display: none;
            z-index: 1000;
        }

        .search-results.active {
            display: block;
            animation: slideIn 0.3s;
        }

        .search-category {
            padding: 12px 20px;
            background: var(--vk-light);
            font-weight: 700;
            color: var(--primary);
        }

        .search-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            border-bottom: 1px solid var(--vk-light);
            transition: all 0.3s;
        }

        .search-item:hover {
            background: var(--vk-light);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-icon {
            font-size: 22px;
            cursor: pointer;
            position: relative;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .header-icon:hover {
            background: var(--vk-light);
        }

        .badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background: var(--danger);
            color: white;
            font-size: 11px;
            padding: 2px 5px;
            border-radius: 50%;
            min-width: 18px;
            text-align: center;
        }

        .avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 18px;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .main-container {
            display: flex;
            max-width: 1200px;
            margin: 20px auto;
            gap: 20px;
            padding: 0 20px;
        }

        /* ========== –õ–ï–í–û–ï –ú–ï–ù–Æ ========== */
        .left-menu {
            flex: 2;
            background: white;
            border-radius: 15px;
            padding: 15px 0;
            height: fit-content;
            position: sticky;
            top: 80px;
            box-shadow: var(--shadow);
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px 20px;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--dark);
            font-weight: 500;
        }

        .menu-item:hover {
            background: var(--vk-light);
        }

        .menu-item.active {
            background: var(--vk-light);
            color: var(--primary);
            border-left: 4px solid var(--primary);
        }

        .menu-item.logout {
            margin-top: 20px;
            border-top: 1px solid var(--vk-light);
            color: var(--danger);
        }

        .menu-item.logout:hover {
            background: #fee;
        }

        /* ========== –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ß–ê–°–¢–¨ ========== */
        .center-content {
            flex: 6;
        }

        /* ========== –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê ========== */
        .right-sidebar {
            flex: 3;
            background: white;
            border-radius: 15px;
            padding: 20px;
            height: fit-content;
            position: sticky;
            top: 80px;
            box-shadow: var(--shadow);
        }

        /* ========== –ü–û–°–¢–´ ========== */
        .create-post {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        .create-post-header {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .create-post-input {
            flex: 1;
            padding: 12px 20px;
            background: var(--vk-light);
            border-radius: 30px;
            cursor: pointer;
            color: var(--gray);
        }

        .create-post-actions {
            display: flex;
            gap: 30px;
            padding-top: 15px;
            border-top: 1px solid var(--vk-light);
        }

        .post-action-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            color: var(--gray);
            transition: all 0.3s;
        }

        .post-action-btn:hover {
            color: var(--primary);
        }

        .post {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            animation: slideIn 0.5s;
        }

        .post-header {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            cursor: pointer;
        }

        .post-author {
            font-weight: 700;
            font-size: 16px;
        }

        .post-time {
            color: var(--gray);
            font-size: 12px;
            margin-top: 3px;
        }

        .post-content {
            margin: 15px 0;
            line-height: 1.6;
        }

        .post-media {
            margin: 15px 0;
            border-radius: 12px;
            overflow: hidden;
            max-width: 100%;
        }

        .post-media img {
            width: 100%;
            max-height: 600px;
            object-fit: contain;
            background: #f5f5f5;
            cursor: pointer;
        }

        .post-media video {
            width: 100%;
            max-height: 500px;
            background: #000;
        }

        .post-stats {
            display: flex;
            gap: 30px;
            padding: 10px 0;
            border-bottom: 1px solid var(--vk-light);
            color: var(--gray);
            font-size: 14px;
        }

        .post-actions {
            display: flex;
            gap: 30px;
            padding-top: 15px;
        }

        .post-action {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            color: var(--gray);
            font-weight: 500;
            transition: all 0.3s;
        }

        .post-action:hover {
            color: var(--primary);
        }

        .post-action.liked {
            color: var(--danger);
        }

        .comments-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--vk-light);
        }

        .comment {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .comment-content {
            background: var(--vk-light);
            padding: 12px 15px;
            border-radius: 18px;
            flex: 1;
        }

        .comment-author {
            font-weight: 700;
            margin-bottom: 5px;
            cursor: pointer;
        }

        .comment-input {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .comment-input input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid var(--vk-light);
            border-radius: 30px;
        }

        .comment-input button {
            padding: 12px 25px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
        }

        /* ========== –ü–†–û–§–ò–õ–¨ ========== */
        .profile-header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            position: relative;
        }

        .profile-cover {
            height: 200px;
            background: var(--gradient-accent);
            border-radius: 12px;
            margin-bottom: 70px;
            position: relative;
        }

        .profile-avatar-large {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 4px solid white;
            position: absolute;
            bottom: -50px;
            left: 30px;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 50px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .profile-avatar-large img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-info {
            padding: 0 20px;
        }

        .profile-name {
            font-size: 28px;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .profile-tag {
            color: var(--gray);
            font-size: 16px;
            margin-bottom: 15px;
        }

        .profile-stats {
            display: flex;
            gap: 30px;
            margin: 20px 0;
        }

        .profile-stat {
            text-align: center;
        }

        .profile-stat-value {
            font-size: 22px;
            font-weight: 700;
            color: var(--primary);
        }

        .profile-stat-label {
            color: var(--gray);
            font-size: 13px;
        }

        .profile-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .profile-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .profile-btn.primary {
            background: var(--primary);
            color: white;
        }

        .profile-btn.secondary {
            background: var(--vk-light);
            color: var(--dark);
        }

        .profile-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        /* ========== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ========== */
        .notifications-panel {
            position: fixed;
            top: 70px;
            right: 20px;
            width: 380px;
            background: white;
            border-radius: 15px;
            box-shadow: var(--shadow-hover);
            display: none;
            z-index: 1000;
            max-height: 500px;
            overflow-y: auto;
        }

        .notifications-panel.active {
            display: block;
            animation: slideIn 0.3s;
        }

        .notifications-header {
            padding: 20px;
            border-bottom: 2px solid var(--vk-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            background: white;
            border-radius: 15px 15px 0 0;
        }

        .notifications-list {
            padding: 10px 0;
        }

        .notification-item {
            padding: 15px 20px;
            border-bottom: 1px solid var(--vk-light);
            cursor: pointer;
            transition: all 0.3s;
        }

        .notification-item:hover {
            background: var(--vk-light);
        }

        .notification-item.unread {
            background: #e3f2fd;
            border-left: 4px solid var(--primary);
        }

        .notification-time {
            font-size: 11px;
            color: var(--gray);
            margin-top: 5px;
        }

        .friend-request-actions {
            display: flex;
            gap: 10px;
            margin-top: 12px;
        }

        .accept-btn {
            padding: 8px 20px;
            background: var(--success);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
        }

        .decline-btn {
            padding: 8px 20px;
            background: var(--gray);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
        }

        /* ========== –°–û–û–ë–©–ï–ù–ò–Ø ========== */
        .messages-container {
            display: flex;
            height: 600px;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .chats-list {
            flex: 2;
            border-right: 1px solid var(--vk-light);
            overflow-y: auto;
        }

        .chat-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            cursor: pointer;
            border-bottom: 1px solid var(--vk-light);
            transition: all 0.3s;
        }

        .chat-item:hover {
            background: var(--vk-light);
        }

        .chat-item.active {
            background: #e3f2fd;
        }

        .chat-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            overflow: hidden;
        }

        .chat-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .chat-info {
            flex: 1;
        }

        .chat-name {
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 5px;
        }

        .last-message {
            color: var(--gray);
            font-size: 13px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .messages-area {
            flex: 5;
            display: flex;
            flex-direction: column;
        }

        .messages-header {
            padding: 20px;
            border-bottom: 1px solid var(--vk-light);
            display: flex;
            align-items: center;
            gap: 15px;
            background: white;
        }

        .messages-list {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            display: flex;
            gap: 10px;
            max-width: 80%;
            animation: slideIn 0.3s;
        }

        .message.outgoing {
            margin-left: auto;
            flex-direction: row-reverse;
        }

        .message-content {
            background: var(--vk-light);
            padding: 12px 18px;
            border-radius: 18px;
            word-break: break-word;
        }

        .message.outgoing .message-content {
            background: var(--primary);
            color: white;
        }

        .message-media {
            max-width: 300px;
            border-radius: 12px;
            cursor: pointer;
            border: 2px solid var(--vk-light);
        }

        .message.outgoing .message-media {
            border-color: white;
        }

        .message-time {
            font-size: 10px;
            color: var(--gray);
            margin-top: 5px;
            text-align: right;
        }

        .message-input-area {
            padding: 20px;
            border-top: 1px solid var(--vk-light);
            display: flex;
            gap: 10px;
            background: white;
        }

        .message-input-area input {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid var(--vk-light);
            border-radius: 30px;
            font-size: 15px;
        }

        .attach-btn {
            padding: 12px 20px;
            background: var(--vk-light);
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s;
        }

        .attach-btn:hover {
            background: var(--primary);
            color: white;
        }

        .send-btn {
            padding: 12px 30px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
        }

        /* ========== –°–û–û–ë–©–ï–°–¢–í–ê ========== */
        .communities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .community-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: all 0.3s;
        }

        .community-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .community-avatar {
            width: 100px;
            height: 100px;
            border-radius: 15px;
            background: var(--gradient);
            margin-bottom: 15px;
            overflow: hidden;
        }

        .community-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .community-name {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .community-members {
            color: var(--gray);
            font-size: 13px;
            margin: 10px 0;
        }

        .community-join-btn {
            width: 100%;
            padding: 10px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .community-join-btn.joined {
            background: var(--success);
        }

        .community-page {
            background: white;
            border-radius: 15px;
            padding: 30px;
        }

        .community-header {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
            padding-bottom: 30px;
            border-bottom: 1px solid var(--vk-light);
        }

        .community-avatar-large {
            width: 150px;
            height: 150px;
            border-radius: 20px;
            background: var(--gradient);
            overflow: hidden;
        }

        .community-avatar-large img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .community-info {
            flex: 1;
        }

        .community-title {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .community-description {
            color: var(--gray);
            margin: 15px 0;
            line-height: 1.6;
        }

        .community-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        /* ========== –ö–ê–ù–ê–õ–´ ========== */
        .channels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .channel-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: all 0.3s;
        }

        .channel-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .channel-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .channel-name {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .channel-stats {
            color: var(--gray);
            font-size: 13px;
            margin: 10px 0;
            display: flex;
            gap: 15px;
        }

        .channel-subscribe-btn {
            width: 100%;
            padding: 10px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        .channel-subscribe-btn.subscribed {
            background: var(--success);
        }

        .channel-page {
            background: white;
            border-radius: 15px;
            padding: 30px;
        }

        .channel-header {
            margin-bottom: 30px;
            padding-bottom: 30px;
            border-bottom: 1px solid var(--vk-light);
        }

        .channel-title {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .channel-posts {
            margin-top: 30px;
        }

        .channel-post {
            background: var(--vk-light);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .channel-post-media {
            max-width: 100%;
            margin-top: 15px;
        }

        .channel-post-media img {
            max-width: 100%;
            border-radius: 10px;
        }

        /* ========== –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ ========== */
        .admin-panel {
            background: var(--dark);
            color: white;
            border-radius: 15px;
            padding: 30px;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .admin-badge {
            background: var(--danger);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 700;
        }

        .verified-badge {
            background: var(--verified);
            color: white;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            margin-left: 5px;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .stat-number {
            font-size: 36px;
            font-weight: 900;
            color: var(--success);
            margin-bottom: 5px;
        }

        .admin-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .admin-section h3 {
            color: var(--success);
            margin-bottom: 20px;
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
        }

        .admin-table th {
            text-align: left;
            padding: 12px;
            color: var(--success);
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .admin-table td {
            padding: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            margin: 0 3px;
        }

        .admin-btn.ban {
            background: var(--danger);
            color: white;
        }

        .admin-btn.verify {
            background: var(--verified);
            color: white;
        }

        .admin-btn.make-admin {
            background: var(--warning);
            color: white;
        }

        /* ========== –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê ========== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            animation: slideIn 0.4s;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-close {
            font-size: 28px;
            cursor: pointer;
            color: var(--gray);
            transition: all 0.3s;
        }

        .modal-close:hover {
            color: var(--danger);
        }

        .modal-input {
            width: 100%;
            padding: 12px 15px;
            margin-bottom: 15px;
            border: 2px solid var(--vk-light);
            border-radius: 10px;
            font-size: 15px;
        }

        .modal-textarea {
            width: 100%;
            padding: 12px 15px;
            margin-bottom: 15px;
            border: 2px solid var(--vk-light);
            border-radius: 10px;
            min-height: 100px;
            font-size: 15px;
        }

        .file-input-wrapper {
            position: relative;
            margin: 15px 0;
        }

        .file-input-wrapper input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 15px;
            background: var(--gradient);
            color: white;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
        }

        .modal-btn {
            width: 100%;
            padding: 14px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin: 10px 0;
        }

        .modal-btn:hover {
            background: var(--primary-dark);
        }

        /* ========== –°–¢–û–†–ò–° ========== */
        .stories-section {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        .stories-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .stories-grid {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            padding: 10px 0;
        }

        .story-item {
            min-width: 100px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .story-item:hover {
            transform: translateY(-5px);
        }

        .story-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--gradient);
            margin: 0 auto 8px;
            border: 3px solid white;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .story-avatar.add {
            background: var(--vk-light);
            border: 2px dashed var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: var(--primary);
        }

        .story-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .story-time {
            font-size: 12px;
            color: var(--gray);
        }

        .story-viewer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 3000;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .story-viewer-content {
            max-width: 500px;
            width: 90%;
            background: #000;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }

        .story-viewer-header {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            color: white;
            z-index: 10;
        }

        .story-progress-bar {
            position: absolute;
            top: 0;
            left: 0;
            height: 4px;
            background: var(--primary);
            transition: width 0.1s linear;
        }

        .story-viewer-media {
            width: 100%;
            max-height: 80vh;
            object-fit: contain;
        }

        .story-viewer-close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 30px;
            cursor: pointer;
            z-index: 10;
        }

        /* ========== –ò–ì–†–´ ========== */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .game-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: all 0.3s;
            text-align: center;
        }

        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .game-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .game-name {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .game-description {
            color: var(--gray);
            font-size: 14px;
        }

        .game-board {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .tic-tac-toe-grid {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            gap: 5px;
            background: var(--primary);
            padding: 5px;
            border-radius: 10px;
        }

        .ttt-cell {
            width: 100px;
            height: 100px;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            font-weight: 700;
            cursor: pointer;
            border-radius: 5px;
        }

        .guess-number-input {
            padding: 10px;
            font-size: 18px;
            width: 200px;
            text-align: center;
            border: 2px solid var(--primary);
            border-radius: 10px;
        }

        .rps-buttons {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .rps-btn {
            padding: 15px 30px;
            font-size: 24px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: 0.3s;
        }

        .rps-btn:hover {
            background: var(--primary-dark);
        }

        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 80px);
            gap: 10px;
            justify-content: center;
        }

        .memory-card {
            width: 80px;
            height: 80px;
            background: var(--primary);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            color: white;
            cursor: pointer;
            transition: 0.3s;
        }

        .memory-card.flipped {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .memory-card.matched {
            background: var(--success);
            color: white;
            cursor: default;
        }

        .snake-board {
            display: grid;
            grid-template-columns: repeat(15, 30px);
            gap: 1px;
            background: #333;
            padding: 1px;
            border-radius: 5px;
        }

        .snake-cell {
            width: 30px;
            height: 30px;
            background: #111;
        }

        .snake-cell.snake {
            background: var(--primary);
        }

        .snake-cell.food {
            background: var(--danger);
        }
        
        /* ========== –†–ï–ö–õ–ê–ú–ê ========== */
        .ad-block {
            background: linear-gradient(145deg, #fff3cd, #ffe69c);
            border: 2px solid #ffc107;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            position: relative;
        }

        .ad-label {
            position: absolute;
            top: 5px;
            right: 10px;
            background: var(--warning);
            color: white;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 700;
        }

        .ad-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .ad-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }
    </style>
</head>
<body>
    <!-- –°–¢–†–ê–ù–ò–¶–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò -->
    <div class="auth-page" id="authPage">
        <div class="auth-container">
            <div class="auth-logo">SKRIP</div>
            <div class="auth-tabs">
                <div class="auth-tab active" onclick="switchAuthTab('login')">–í—Ö–æ–¥</div>
                <div class="auth-tab" onclick="switchAuthTab('register')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
            </div>
            
            <div class="auth-form" id="loginForm">
                <input type="text" id="loginEmail" placeholder="Email –∏–ª–∏ –ª–æ–≥–∏–Ω">
                <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å">
                <button class="auth-btn" onclick="handleLogin()">–í–æ–π—Ç–∏</button>
                <div class="admin-link" onclick="openModal('adminLoginModal')">üîê –í—Ö–æ–¥ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏</div>
            </div>
            
            <div class="auth-form" id="registerForm" style="display: none;">
                <input type="text" id="regName" placeholder="–ò–º—è">
                <input type="text" id="regSurname" placeholder="–§–∞–º–∏–ª–∏—è">
                <input type="text" id="regTag" placeholder="–¢–µ–≥ (–Ω–∞–ø—Ä–∏–º–µ—Ä: @ivan)">
                <input type="email" id="regEmail" placeholder="Email">
                <input type="password" id="regPassword" placeholder="–ü–∞—Ä–æ–ª—å (–º–∏–Ω. 6 —Å–∏–º–≤–æ–ª–æ–≤)">
                <input type="password" id="regConfirmPassword" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                <button class="auth-btn" onclick="handleRegister()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ê–î–ú–ò–ù –í–•–û–î–ê -->
    <div class="modal" id="adminLoginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üîê –í—Ö–æ–¥ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏</h2>
                <span class="modal-close" onclick="closeModal('adminLoginModal')">&times;</span>
            </div>
            <input type="password" id="adminCode" class="modal-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥">
            <button class="modal-btn" onclick="verifyAdminCode()">–í–æ–π—Ç–∏</button>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –í–´–î–ê–ß–ò –ö–û–î–ê –ê–î–ú–ò–ù–ê -->
    <div class="modal" id="adminCodeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üé´ –í—ã–¥–∞—á–∞ –∫–æ–¥–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
                <span class="modal-close" onclick="closeModal('adminCodeModal')">&times;</span>
            </div>
            <p>–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–æ–¥ –¥–ª—è –Ω–æ–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:</p>
            <div class="admin-code" id="generatedAdminCode" style="background: #eee; padding: 15px; border-radius: 10px; font-family: monospace; font-size: 20px; margin: 15px 0;">ADMIN-XXXX-XXXX</div>
            <button class="modal-btn" onclick="generateAdminCode()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–¥</button>
            <p style="color: var(--gray); margin-top: 15px;">–ö–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 24 —á–∞—Å–∞</p>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –°–û–ó–î–ê–ù–ò–Ø –°–¢–û–†–ò–° -->
    <div class="modal" id="storyModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üì± –°–æ–∑–¥–∞—Ç—å —Å—Ç–æ—Ä–∏—Å</h2>
                <span class="modal-close" onclick="closeModal('storyModal')">&times;</span>
            </div>
            <div class="file-input-wrapper">
                <input type="file" id="storyMedia" accept="image/*,video/*">
                <label for="storyMedia" class="file-input-label">
                    <span>üìé</span> –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ –∏–ª–∏ –≤–∏–¥–µ–æ
                </label>
            </div>
            <button class="modal-btn" onclick="createStory()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø –†–ï–ö–õ–ê–ú–´ (–ù–û–í–û–ï) -->
    <div class="modal" id="adModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="adModalTitle">‚ûï –°–æ–∑–¥–∞—Ç—å —Ä–µ–∫–ª–∞–º—É</h2>
                <span class="modal-close" onclick="closeModal('adModal')">&times;</span>
            </div>
            <input type="text" id="adTitle" class="modal-input" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–µ–∫–ª–∞–º—ã">
            <textarea id="adText" class="modal-textarea" placeholder="–¢–µ–∫—Å—Ç —Ä–µ–∫–ª–∞–º—ã"></textarea>
            <input type="text" id="adLink" class="modal-input" placeholder="–°—Å—ã–ª–∫–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
            <div class="file-input-wrapper">
                <input type="file" id="adImage" accept="image/*">
                <label for="adImage" class="file-input-label">
                    <span>üñºÔ∏è</span> –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                </label>
            </div>
            <button class="modal-btn" id="adSaveBtn" onclick="saveAd()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê –î–õ–Ø –ò–ì–† -->
    <div class="modal" id="gameTicTacToeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ùå –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ ‚≠ï</h2>
                <span class="modal-close" onclick="closeModal('gameTicTacToeModal')">&times;</span>
            </div>
            <div class="game-board">
                <div id="ttc-status" style="font-weight: 700; margin-bottom: 10px;">–•–æ–¥: X</div>
                <div class="tic-tac-toe-grid" id="ttc-grid"></div>
                <button class="auth-btn" onclick="resetTicTacToe()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
            </div>
        </div>
    </div>

    <div class="modal" id="gameGuessNumberModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üî¢ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ</h2>
                <span class="modal-close" onclick="closeModal('gameGuessNumberModal')">&times;</span>
            </div>
            <div class="game-board">
                <p>–Ø –∑–∞–≥–∞–¥–∞–ª —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 100. –ü–æ–ø—Ä–æ–±—É–π —É–≥–∞–¥–∞—Ç—å!</p>
                <input type="number" id="guess-input" class="guess-number-input" placeholder="–¢–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç">
                <button class="auth-btn" onclick="checkGuess()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                <p id="guess-hint"></p>
                <button class="auth-btn" onclick="resetGuessGame()">–ó–∞–Ω–æ–≤–æ</button>
            </div>
        </div>
    </div>

    <div class="modal" id="gameRPSModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚úÇÔ∏è –ö–∞–º–µ–Ω—å, –Ω–æ–∂–Ω–∏—Ü—ã, –±—É–º–∞–≥–∞</h2>
                <span class="modal-close" onclick="closeModal('gameRPSModal')">&times;</span>
            </div>
            <div class="game-board">
                <div class="rps-buttons">
                    <button class="rps-btn" onclick="playRPS('–∫–∞–º–µ–Ω—å')">ü™® –ö–∞–º–µ–Ω—å</button>
                    <button class="rps-btn" onclick="playRPS('–Ω–æ–∂–Ω–∏—Ü—ã')">‚úÇÔ∏è –ù–æ–∂–Ω–∏—Ü—ã</button>
                    <button class="rps-btn" onclick="playRPS('–±—É–º–∞–≥–∞')">üìÑ –ë—É–º–∞–≥–∞</button>
                </div>
                <p id="rps-result"></p>
            </div>
        </div>
    </div>

    <div class="modal" id="gameMemoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üß† –ù–∞–π–¥–∏ –ø–∞—Ä—É</h2>
                <span class="modal-close" onclick="closeModal('gameMemoryModal')">&times;</span>
            </div>
            <div class="game-board">
                <div class="memory-grid" id="memory-grid"></div>
                <p id="memory-moves">–•–æ–¥–æ–≤: 0</p>
                <button class="auth-btn" onclick="initMemoryGame()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
            </div>
        </div>
    </div>

    <div class="modal" id="gameSnakeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üêç –ó–º–µ–π–∫–∞</h2>
                <span class="modal-close" onclick="closeModal('gameSnakeModal')">&times;</span>
            </div>
            <div class="game-board">
                <div class="snake-board" id="snake-board"></div>
                <p id="snake-score">–°—á—ë—Ç: 0</p>
                <p>–£–ø—Ä–∞–≤–ª—è–π —Å—Ç—Ä–µ–ª–∫–∞–º–∏</p>
                <button class="auth-btn" onclick="resetSnake()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
            </div>
        </div>
    </div>

    <!-- –û–°–ù–û–í–ù–ê–Ø –°–û–¶–°–ï–¢–¨ -->
    <div class="social-page" id="socialPage">
        <!-- –®–ê–ü–ö–ê -->
        <header class="header">
            <div class="header-left">
                <div class="logo" onclick="showFeed()">SKRIP</div>
                <div class="search">
                    <input type="text" placeholder="–ü–æ–∏—Å–∫" oninput="searchGlobal(this.value)" id="searchInput">
                    <div class="search-results" id="searchResults"></div>
                </div>
            </div>
            <div class="header-right">
                <span class="header-icon" onclick="toggleNotifications()">
                    üîî
                    <span class="badge" id="notificationBadge" style="display: none;">0</span>
                </span>
                <span class="header-icon" onclick="showMessages()">üí¨</span>
                <div class="avatar" id="headerAvatar" onclick="showMyProfile()"></div>
            </div>
        </header>

        <!-- –ü–ê–ù–ï–õ–¨ –£–í–ï–î–û–ú–õ–ï–ù–ò–ô -->
        <div class="notifications-panel" id="notificationsPanel">
            <div class="notifications-header">
                <h3>üì¨ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
                <span style="cursor: pointer;" onclick="toggleNotifications()">‚úï</span>
            </div>
            <div class="notifications-list" id="notificationsList"></div>
        </div>

        <div class="main-container">
            <!-- –õ–ï–í–û–ï –ú–ï–ù–Æ -->
            <div class="left-menu">
                <div class="menu-item active" onclick="showFeed()">
                    <span>üè†</span> –ù–æ–≤–æ—Å—Ç–∏
                </div>
                <div class="menu-item" onclick="showMyProfile()">
                    <span>üë§</span> –ú–æ—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
                </div>
                <div class="menu-item" onclick="showFriends()">
                    <span>üë•</span> –î—Ä—É–∑—å—è
                </div>
                <div class="menu-item" onclick="showMessages()">
                    <span>üí¨</span> –°–æ–æ–±—â–µ–Ω–∏—è
                </div>
                <div class="menu-item" onclick="showCommunities()">
                    <span>üè¢</span> –°–æ–æ–±—â–µ—Å—Ç–≤–∞
                </div>
                <div class="menu-item" onclick="showChannels()">
                    <span>üì¢</span> –ö–∞–Ω–∞–ª—ã
                </div>
                <div class="menu-item" onclick="showGames()">
                    <span>üéÆ</span> –ò–≥—Ä—ã
                </div>
                <div class="menu-item" id="adminMenuItem" style="display: none;" onclick="showAdminPanel()">
                    <span>‚ö°</span> –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
                </div>
                <div class="menu-item logout" onclick="logout()">
                    <span>üö™</span> –í—ã–π—Ç–∏
                </div>
            </div>

            <!-- –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ß–ê–°–¢–¨ -->
            <div class="center-content" id="feedContent">
                <!-- –†–ï–ö–õ–ê–ú–ê (–í–ï–†–•–ù–ò–ô –ë–õ–û–ö) -->
                <div id="adBlockTop" style="display: none;"></div>

                <!-- –°–¢–û–†–ò–° -->
                <div class="stories-section">
                    <div class="stories-header">
                        <h3>–°—Ç–æ—Ä–∏—Å</h3>
                        <span style="color: var(--primary); cursor: pointer;" onclick="openModal('storyModal')">‚ûï –î–æ–±–∞–≤–∏—Ç—å</span>
                    </div>
                    <div class="stories-grid" id="storiesGrid"></div>
                </div>

                <!-- –°–û–ó–î–ê–ù–ò–ï –ü–û–°–¢–ê -->
                <div class="create-post">
                    <div class="create-post-header">
                        <div class="avatar" id="postAvatar"></div>
                        <div class="create-post-input" onclick="openModal('postModal')">
                            –ß—Ç–æ —É –≤–∞—Å –Ω–æ–≤–æ–≥–æ?
                        </div>
                    </div>
                    <div class="create-post-actions">
                        <div class="post-action-btn" onclick="openModal('postModal'); document.getElementById('postMedia').click()">
                            <span>üì∑</span> –§–æ—Ç–æ
                        </div>
                        <div class="post-action-btn" onclick="openModal('postModal'); document.getElementById('postMedia').click()">
                            <span>üé•</span> –í–∏–¥–µ–æ
                        </div>
                    </div>
                </div>

                <!-- –õ–ï–ù–¢–ê –ü–û–°–¢–û–í -->
                <div id="postsFeed"></div>
            </div>

            <!-- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê -->
            <div class="right-sidebar">
                <h3 style="margin-bottom: 20px;">üë• –î—Ä—É–∑—å—è –æ–Ω–ª–∞–π–Ω</h3>
                <div id="onlineFriends"></div>
                <!-- –†–ï–ö–õ–ê–ú–ê (–ë–û–ö–û–í–ê–Ø) -->
                <div id="adBlockSide" style="margin-top: 20px;"></div>
            </div>
        </div>

        <!-- –°–¢–†–ê–ù–ò–¶–ê –ü–†–û–§–ò–õ–Ø -->
        <div class="center-content" id="profilePage" style="display: none;"></div>

        <!-- –°–¢–†–ê–ù–ò–¶–ê –î–†–£–ó–ï–ô -->
        <div class="center-content" id="friendsPage" style="display: none;"></div>

        <!-- –°–¢–†–ê–ù–ò–¶–ê –°–û–û–ë–©–ï–ù–ò–ô -->
        <div class="center-content" id="messagesPage" style="display: none;">
            <div class="messages-container">
                <div class="chats-list" id="chatsList"></div>
                <div class="messages-area" id="messagesArea">
                    <div class="messages-header" id="messagesHeader">
                        <div class="chat-avatar" id="currentChatAvatar">?</div>
                        <h4 id="currentChatName">–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç</h4>
                    </div>
                    <div class="messages-list" id="messagesList"></div>
                    <div class="message-input-area" id="messageInputArea" style="display: none;">
                        <input type="file" id="messageFile" accept="image/*" style="display: none;" onchange="sendMessageWithFile()">
                        <button class="attach-btn" onclick="document.getElementById('messageFile').click()">üìé</button>
                        <input type="text" id="messageInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                        <button class="send-btn" onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –°–¢–†–ê–ù–ò–¶–ê –°–û–û–ë–©–ï–°–¢–í -->
        <div class="center-content" id="communitiesPage" style="display: none;"></div>

        <!-- –°–¢–†–ê–ù–ò–¶–ê –ö–ê–ù–ê–õ–û–í -->
        <div class="center-content" id="channelsPage" style="display: none;"></div>

        <!-- –°–¢–†–ê–ù–ò–¶–ê –ò–ì–† -->
        <div class="center-content" id="gamesPage" style="display: none;">
            <div style="background: white; border-radius: 15px; padding: 25px;">
                <h2>üéÆ –ò–≥—Ä—ã</h2>
                <p style="color: var(--gray); margin: 15px 0;">–í—ã–±–µ—Ä–∏ –∏–≥—Ä—É –∏ —Ä–∞—Å—Å–ª–∞–±—å—Å—è!</p>
                <div class="games-grid">
                    <div class="game-card" onclick="openModal('gameTicTacToeModal'); initTicTacToe()">
                        <div class="game-icon">‚ùå‚≠ï</div>
                        <div class="game-name">–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</div>
                        <div class="game-description">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∏–≥—Ä–∞ –Ω–∞ –¥–≤–æ–∏—Ö. –°—ã–≥—Ä–∞–π —Å –¥—Ä—É–≥–æ–º!</div>
                    </div>
                    <div class="game-card" onclick="openModal('gameGuessNumberModal'); resetGuessGame()">
                        <div class="game-icon">üî¢</div>
                        <div class="game-name">–£–≥–∞–¥–∞–π —á–∏—Å–ª–æ</div>
                        <div class="game-description">–ö–æ–º–ø—å—é—Ç–µ—Ä –∑–∞–≥–∞–¥–∞–ª —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 100. –°–º–æ–∂–µ—à—å —É–≥–∞–¥–∞—Ç—å?</div>
                    </div>
                    <div class="game-card" onclick="openModal('gameRPSModal')">
                        <div class="game-icon">‚úÇÔ∏èüìÑü™®</div>
                        <div class="game-name">–ö–∞–º–µ–Ω—å, –Ω–æ–∂–Ω–∏—Ü—ã, –±—É–º–∞–≥–∞</div>
                        <div class="game-description">–°—ã–≥—Ä–∞–π –ø—Ä–æ—Ç–∏–≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞!</div>
                    </div>
                    <div class="game-card" onclick="openModal('gameMemoryModal'); initMemoryGame()">
                        <div class="game-icon">üß†</div>
                        <div class="game-name">–ù–∞–π–¥–∏ –ø–∞—Ä—É</div>
                        <div class="game-description">–¢—Ä–µ–Ω–∏—Ä—É–π –ø–∞–º—è—Ç—å, —Å–æ–±–∏—Ä–∞—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏.</div>
                    </div>
                    <div class="game-card" onclick="openModal('gameSnakeModal'); initSnake()">
                        <div class="game-icon">üêç</div>
                        <div class="game-name">–ó–º–µ–π–∫–∞</div>
                        <div class="game-description">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∑–º–µ–π–∫–∞. –°–æ–±–∏—Ä–∞–π –µ–¥—É –∏ –Ω–µ –≤—Ä–µ–∑–∞–π—Å—è –≤ —Å—Ç–µ–Ω—ã!</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ -->
        <div class="center-content" id="adminPage" style="display: none;">
            <div class="admin-panel" id="adminPanel"></div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –°–û–ó–î–ê–ù–ò–Ø –ü–û–°–¢–ê -->
    <div class="modal" id="postModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å</h2>
                <span class="modal-close" onclick="closeModal('postModal')">&times;</span>
            </div>
            <textarea id="postText" class="modal-textarea" placeholder="–ß—Ç–æ —É –≤–∞—Å –Ω–æ–≤–æ–≥–æ?"></textarea>
            <div class="file-input-wrapper">
                <input type="file" id="postMedia" accept="image/*,video/*">
                <label for="postMedia" class="file-input-label">
                    <span>üìé</span> –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–æ—Ç–æ –∏–ª–∏ –≤–∏–¥–µ–æ
                </label>
            </div>
            <button class="modal-btn" onclick="createPost()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø –ü–†–û–§–ò–õ–Ø -->
    <div class="modal" id="editProfileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</h2>
                <span class="modal-close" onclick="closeModal('editProfileModal')">&times;</span>
            </div>
            <input type="text" id="editName" class="modal-input" placeholder="–ò–º—è">
            <input type="text" id="editSurname" class="modal-input" placeholder="–§–∞–º–∏–ª–∏—è">
            <input type="text" id="editTag" class="modal-input" placeholder="–¢–µ–≥">
            <div class="file-input-wrapper">
                <input type="file" id="editAvatar" accept="image/*">
                <label for="editAvatar" class="file-input-label">
                    <span>üì∑</span> –ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä
                </label>
            </div>
            <button class="modal-btn" onclick="saveProfile()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –°–û–ó–î–ê–ù–ò–Ø –°–û–û–ë–©–ï–°–¢–í–ê -->
    <div class="modal" id="communityModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–°–æ–∑–¥–∞—Ç—å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ</h2>
                <span class="modal-close" onclick="closeModal('communityModal')">&times;</span>
            </div>
            <input type="text" id="communityName" class="modal-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞">
            <textarea id="communityDesc" class="modal-textarea" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"></textarea>
            <div class="file-input-wrapper">
                <input type="file" id="communityAvatar" accept="image/*">
                <label for="communityAvatar" class="file-input-label">
                    <span>üè¢</span> –ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä
                </label>
            </div>
            <button class="modal-btn" onclick="createCommunity()">–°–æ–∑–¥–∞—Ç—å</button>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –°–û–ó–î–ê–ù–ò–Ø –ö–ê–ù–ê–õ–ê -->
    <div class="modal" id="channelModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–°–æ–∑–¥–∞—Ç—å –∫–∞–Ω–∞–ª</h2>
                <span class="modal-close" onclick="closeModal('channelModal')">&times;</span>
            </div>
            <input type="text" id="channelName" class="modal-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞">
            <textarea id="channelDesc" class="modal-textarea" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"></textarea>
            <div class="file-input-wrapper">
                <input type="file" id="channelAvatar" accept="image/*">
                <label for="channelAvatar" class="file-input-label">
                    <span>üì¢</span> –ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä
                </label>
            </div>
            <button class="modal-btn" onclick="createChannel()">–°–æ–∑–¥–∞—Ç—å</button>
        </div>
    </div>

    <script>
        // ========== –î–ê–ù–ù–´–ï ==========
        let currentUser = null;
        let users = JSON.parse(localStorage.getItem('skrip_users')) || [];
        let posts = JSON.parse(localStorage.getItem('skrip_posts')) || [];
        let messages = JSON.parse(localStorage.getItem('skrip_messages')) || [];
        let communities = JSON.parse(localStorage.getItem('skrip_communities')) || [];
        let channels = JSON.parse(localStorage.getItem('skrip_channels')) || [];
        let notifications = JSON.parse(localStorage.getItem('skrip_notifications')) || [];
        let friendRequests = JSON.parse(localStorage.getItem('skrip_friendRequests')) || [];
        let stories = JSON.parse(localStorage.getItem('skrip_stories')) || [];
        let ads = JSON.parse(localStorage.getItem('skrip_ads')) || [];
        let adminCodes = JSON.parse(localStorage.getItem('skrip_adminCodes')) || [];

        const MASTER_ADMIN_ID = "master_admin";
        const MASTER_CODE = "MASTER2026";

        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
        function init() {
            // –°–æ–∑–¥–∞–µ–º –º–∞—Å—Ç–µ—Ä-–∞–¥–º–∏–Ω–∞
            if (!users.find(u => u.isMasterAdmin)) {
                users.push({
                    id: MASTER_ADMIN_ID,
                    name: 'Master',
                    surname: 'Admin',
                    tag: '@master',
                    email: 'master@skrip.ru',
                    password: 'admin123',
                    avatar: null,
                    isPrivate: false,
                    isAdmin: true,
                    isMasterAdmin: true,
                    isVerified: true,
                    friends: [],
                    communities: [],
                    channels: []
                });
            }

            // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            if (users.length === 1) {
                users.push(
                    {
                        id: Date.now() + 1,
                        name: '–ò–≤–∞–Ω',
                        surname: '–ü–µ—Ç—Ä–æ–≤',
                        tag: '@ivan',
                        email: 'ivan@test.com',
                        password: '123456',
                        avatar: null,
                        isPrivate: false,
                        isAdmin: false,
                        isVerified: false,
                        friends: [],
                        communities: [],
                        channels: []
                    },
                    {
                        id: Date.now() + 2,
                        name: '–ê–Ω–Ω–∞',
                        surname: '–°–º–∏—Ä–Ω–æ–≤–∞',
                        tag: '@anna',
                        email: 'anna@test.com',
                        password: '123456',
                        avatar: null,
                        isPrivate: false,
                        isAdmin: false,
                        isVerified: true,
                        friends: [],
                        communities: [],
                        channels: []
                    }
                );
            }

            // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —Å—Ç–æ—Ä–∏—Å
            if (stories.length === 0) {
                stories.push({
                    id: Date.now() + 1000,
                    userId: MASTER_ADMIN_ID,
                    author: 'Master Admin',
                    media: null,
                    time: new Date().toLocaleString(),
                    timestamp: Date.now()
                });
            }

            saveAll();
            currentUser = JSON.parse(localStorage.getItem('skrip_currentUser'));
            if (currentUser) {
                showSocialPage();
                updateUI();
            }
        }

        function saveAll() {
            localStorage.setItem('skrip_users', JSON.stringify(users));
            localStorage.setItem('skrip_posts', JSON.stringify(posts));
            localStorage.setItem('skrip_messages', JSON.stringify(messages));
            localStorage.setItem('skrip_communities', JSON.stringify(communities));
            localStorage.setItem('skrip_channels', JSON.stringify(channels));
            localStorage.setItem('skrip_notifications', JSON.stringify(notifications));
            localStorage.setItem('skrip_friendRequests', JSON.stringify(friendRequests));
            localStorage.setItem('skrip_stories', JSON.stringify(stories));
            localStorage.setItem('skrip_ads', JSON.stringify(ads));
            localStorage.setItem('skrip_adminCodes', JSON.stringify(adminCodes));
        }

        // ========== –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê ==========
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // ========== –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø ==========
        function switchAuthTab(tab) {
            document.querySelectorAll('.auth-tab').forEach((el, i) => {
                el.classList.toggle('active', (tab === 'login' && i === 0) || (tab === 'register' && i === 1));
            });
            document.getElementById('loginForm').style.display = tab === 'login' ? 'block' : 'none';
            document.getElementById('registerForm').style.display = tab === 'register' ? 'block' : 'none';
        }

        function validateEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        function handleRegister() {
            const inputs = {
                name: document.getElementById('regName'),
                surname: document.getElementById('regSurname'),
                tag: document.getElementById('regTag'),
                email: document.getElementById('regEmail'),
                password: document.getElementById('regPassword'),
                confirm: document.getElementById('regConfirmPassword')
            };

            for (let [key, input] of Object.entries(inputs)) {
                if (!input.value.trim()) {
                    input.classList.add('error');
                    setTimeout(() => input.classList.remove('error'), 2000);
                    alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
                    return;
                }
            }

            if (!validateEmail(inputs.email.value)) {
                inputs.email.classList.add('error');
                alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email!');
                return;
            }

            if (inputs.password.value.length < 6) {
                inputs.password.classList.add('error');
                alert('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤!');
                return;
            }

            if (inputs.password.value !== inputs.confirm.value) {
                inputs.confirm.classList.add('error');
                alert('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!');
                return;
            }

            if (users.find(u => u.email === inputs.email.value)) {
                alert('Email —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è!');
                return;
            }

            const newUser = {
                id: Date.now(),
                name: inputs.name.value,
                surname: inputs.surname.value,
                tag: inputs.tag.value,
                email: inputs.email.value,
                password: inputs.password.value,
                avatar: null,
                isPrivate: false,
                isAdmin: false,
                isMasterAdmin: false,
                isVerified: false,
                friends: [],
                communities: [],
                channels: []
            };

            users.push(newUser);
            currentUser = newUser;
            localStorage.setItem('skrip_currentUser', JSON.stringify(currentUser));
            saveAll();
            showSocialPage();
            updateUI();
            addNotification(currentUser.id, 'system', null, '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ SKRIP! üéâ');
        }

        function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const user = users.find(u => (u.email === email || u.tag === email) && u.password === password);

            if (user) {
                currentUser = user;
                localStorage.setItem('skrip_currentUser', JSON.stringify(currentUser));
                showSocialPage();
                updateUI();
            } else {
                alert('–ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ!');
            }
        }

        // ========== –ê–î–ú–ò–ù –§–£–ù–ö–¶–ò–ò ==========
        function verifyAdminCode() {
            const code = document.getElementById('adminCode').value;
            
            if (code === MASTER_CODE) {
                const admin = users.find(u => u.isMasterAdmin);
                if (admin) {
                    currentUser = admin;
                    localStorage.setItem('skrip_currentUser', JSON.stringify(currentUser));
                    closeModal('adminLoginModal');
                    showSocialPage();
                    updateUI();
                    alert('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, Master Admin!');
                    return;
                }
            }

            const validCode = adminCodes.find(c => c.code === code && !c.used && c.expiresAt > Date.now());
            if (validCode) {
                const adminUser = {
                    id: Date.now(),
                    name: 'Admin',
                    surname: 'User',
                    tag: '@admin' + Date.now(),
                    email: `admin${Date.now()}@skrip.ru`,
                    password: 'admin123',
                    avatar: null,
                    isPrivate: false,
                    isAdmin: true,
                    isMasterAdmin: false,
                    isVerified: true,
                    friends: [],
                    communities: [],
                    channels: []
                };

                users.push(adminUser);
                currentUser = adminUser;
                localStorage.setItem('skrip_currentUser', JSON.stringify(currentUser));
                
                validCode.used = true;
                
                saveAll();
                closeModal('adminLoginModal');
                showSocialPage();
                updateUI();
                alert('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä!');
            } else {
                alert('–ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–π –∫–æ–¥!');
            }
        }

        function generateAdminCode() {
            if (!currentUser?.isMasterAdmin) {
                alert('–¢–æ–ª—å–∫–æ Master Admin –º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥—ã!');
                return;
            }

            const code = 'ADMIN-' + 
                Math.random().toString(36).substring(2, 6).toUpperCase() + '-' +
                Math.random().toString(36).substring(2, 6).toUpperCase();
            
            document.getElementById('generatedAdminCode').textContent = code;
            
            adminCodes.push({
                code: code,
                createdBy: currentUser.id,
                createdAt: Date.now(),
                expiresAt: Date.now() + 24 * 60 * 60 * 1000,
                used: false
            });
            
            saveAll();
        }

        function makeAdmin(userId) {
            if (!currentUser?.isMasterAdmin) {
                alert('–¢–æ–ª—å–∫–æ Master Admin –º–æ–∂–µ—Ç –Ω–∞–∑–Ω–∞—á–∞—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤!');
                return;
            }
            const user = users.find(u => u.id === userId);
            if (user) {
                user.isAdmin = true;
                saveAll();
                renderAdminPanel();
                addNotification(userId, 'system', null, '–í–∞–º –≤—ã–¥–∞–Ω—ã –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!');
            }
        }

        function removeAdmin(userId) {
            if (!currentUser?.isMasterAdmin) {
                alert('–¢–æ–ª—å–∫–æ Master Admin –º–æ–∂–µ—Ç —Å–Ω–∏–º–∞—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤!');
                return;
            }
            const user = users.find(u => u.id === userId);
            if (user) {
                user.isAdmin = false;
                saveAll();
                renderAdminPanel();
            }
        }

        function banUser(userId) {
            if (!currentUser?.isAdmin) {
                alert('–ù–µ—Ç –ø—Ä–∞–≤!');
                return;
            }
            if (confirm('–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?')) {
                users = users.filter(u => u.id !== userId);
                posts = posts.filter(p => p.userId !== userId);
                notifications = notifications.filter(n => n.userId !== userId);
                saveAll();
                if (document.getElementById('adminPage').style.display === 'block') {
                    renderAdminPanel();
                }
            }
        }

        function verifyUser(userId) {
            if (!currentUser?.isAdmin) {
                alert('–ù–µ—Ç –ø—Ä–∞–≤!');
                return;
            }
            const user = users.find(u => u.id === userId);
            if (user) {
                user.isVerified = !user.isVerified;
                saveAll();
                if (document.getElementById('adminPage').style.display === 'block') {
                    renderAdminPanel();
                }
                addNotification(userId, 'system', null, 
                    user.isVerified ? '–í—ã –ø–æ–ª—É—á–∏–ª–∏ —Å–∏–Ω—é—é –≥–∞–ª–æ—á–∫—É! ‚úì' : '–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Ç–æ–∑–≤–∞–Ω–∞');
            }
        }

        function deleteCommunity(commId) {
            if (!currentUser?.isAdmin) return;
            if (confirm('–£–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ?')) {
                communities = communities.filter(c => c.id !== commId);
                saveAll();
                showCommunities();
            }
        }

        function deleteChannel(channelId) {
            if (!currentUser?.isAdmin) return;
            if (confirm('–£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª?')) {
                channels = channels.filter(c => c.id !== channelId);
                saveAll();
                showChannels();
            }
        }

        // ========== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ï–ö–õ–ê–ú–´ (–ù–û–í–´–ï) ==========
        function openAdModal() {
            document.getElementById('adModalTitle').textContent = '‚ûï –°–æ–∑–¥–∞—Ç—å —Ä–µ–∫–ª–∞–º—É';
            document.getElementById('adTitle').value = '';
            document.getElementById('adText').value = '';
            document.getElementById('adLink').value = '';
            document.getElementById('adImage').value = '';
            document.getElementById('adSaveBtn').onclick = () => saveAd();
            openModal('adModal');
        }

        function editAd(adId) {
            const ad = ads.find(a => a.id == adId);
            if (!ad) return;
            document.getElementById('adModalTitle').textContent = '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∫–ª–∞–º—É';
            document.getElementById('adTitle').value = ad.title;
            document.getElementById('adText').value = ad.text;
            document.getElementById('adLink').value = ad.link || '';
            document.getElementById('adImage').value = '';
            document.getElementById('adSaveBtn').onclick = () => saveAd(adId);
            openModal('adModal');
        }

        function saveAd(adId = null) {
            const title = document.getElementById('adTitle').value.trim();
            const text = document.getElementById('adText').value.trim();
            const link = document.getElementById('adLink').value.trim();
            const imageFile = document.getElementById('adImage').files[0];

            if (!title || !text) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Ç–µ–∫—Å—Ç!');
                return;
            }

            const process = (imageData) => {
                if (adId) {
                    const ad = ads.find(a => a.id == adId);
                    if (ad) {
                        ad.title = title;
                        ad.text = text;
                        ad.link = link;
                        if (imageData) ad.image = imageData;
                    }
                } else {
                    const newAd = {
                        id: Date.now(),
                        title: title,
                        text: text,
                        link: link,
                        image: imageData || null,
                        createdBy: currentUser.id,
                        createdAt: new Date().toLocaleString()
                    };
                    ads.push(newAd);
                }
                saveAll();
                closeModal('adModal');
                renderAdminPanel();
                updateAds();
            };

            if (imageFile) {
                const reader = new FileReader();
                reader.onload = (e) => process(e.target.result);
                reader.readAsDataURL(imageFile);
            } else {
                process(null);
            }
        }

        function deleteAd(adId) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ?')) return;
            ads = ads.filter(a => a.id != adId);
            saveAll();
            renderAdminPanel();
            updateAds();
        }

        function updateAds() {
            if (!currentUser?.isAdmin) return;

            // –†–µ–∫–ª–∞–º–∞ –≤ –ø—Ä–∞–≤–æ–π –∫–æ–ª–æ–Ω–∫–µ
            const sideAds = ads.slice(-3).map(ad => `
                <div class="ad-block">
                    <span class="ad-label">–†–µ–∫–ª–∞–º–∞</span>
                    <div style="text-align: center;">
                        ${ad.image ? `<img src="${ad.image}" style="max-width: 100%; max-height: 100px; border-radius: 10px; margin-bottom: 10px;">` : ''}
                        <strong>${ad.title}</strong>
                        <p style="color: var(--gray); margin: 10px 0;">${ad.text}</p>
                        ${ad.link ? `<a href="${ad.link}" target="_blank" class="auth-btn" style="display: inline-block; padding: 8px 20px;">–ü–µ—Ä–µ–π—Ç–∏</a>` : ''}
                    </div>
                </div>
            `).join('');

            document.getElementById('adBlockSide').innerHTML = sideAds;

            // –†–µ–∫–ª–∞–º–∞ –≤ –ª–µ–Ω—Ç–µ (—Å–∞–º–æ–µ —Å–≤–µ–∂–µ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ)
            if (ads.length > 0) {
                const topAd = ads[ads.length - 1];
                document.getElementById('adBlockTop').innerHTML = `
                    <div class="ad-block">
                        <span class="ad-label">–†–µ–∫–ª–∞–º–∞</span>
                        <div style="display: flex; align-items: center; gap: 15px;">
                            ${topAd.image ? `<img src="${topAd.image}" style="width: 80px; height: 80px; border-radius: 10px; object-fit: cover;">` : ''}
                            <div>
                                <strong>${topAd.title}</strong>
                                <p style="color: var(--gray); margin: 5px 0;">${topAd.text}</p>
                                ${topAd.link ? `<a href="${topAd.link}" target="_blank" style="color: var(--primary);">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>` : ''}
                            </div>
                        </div>
                    </div>
                `;
                document.getElementById('adBlockTop').style.display = 'block';
            } else {
                document.getElementById('adBlockTop').style.display = 'none';
            }
        }

        // ========== –°–¢–û–†–ò–° ==========
        function createStory() {
            const file = document.getElementById('storyMedia').files[0];
            if (!file) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ç–æ –∏–ª–∏ –≤–∏–¥–µ–æ!');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                const newStory = {
                    id: Date.now(),
                    userId: currentUser.id,
                    author: `${currentUser.name} ${currentUser.surname}`,
                    authorAvatar: currentUser.avatar,
                    media: e.target.result,
                    mediaType: file.type.startsWith('image/') ? 'image' : 'video',
                    time: new Date().toLocaleString(),
                    timestamp: Date.now()
                };

                stories.push(newStory);
                saveAll();
                closeModal('storyModal');
                updateStories();

                currentUser.friends?.forEach(friendId => {
                    addNotification(friendId, 'story', currentUser.id,
                        `${currentUser.name} ${currentUser.surname} –¥–æ–±–∞–≤–∏–ª(–∞) –Ω–æ–≤—É—é —Å—Ç–æ—Ä–∏—Å`);
                });
            };
            reader.readAsDataURL(file);
        }

        function updateStories() {
            const grid = document.getElementById('storiesGrid');
            if (!grid) return;

            const now = Date.now();
            const last24h = now - 24 * 60 * 60 * 1000;
            const recentStories = stories.filter(s => s.timestamp > last24h).reverse();

            let html = `
                <div class="story-item" onclick="openModal('storyModal')">
                    <div class="story-avatar add">+</div>
                    <div>–î–æ–±–∞–≤–∏—Ç—å</div>
                </div>
            `;

            recentStories.forEach(story => {
                const user = users.find(u => u.id === story.userId);
                html += `
                    <div class="story-item" onclick="viewStory(${story.id})">
                        <div class="story-avatar">
                            ${story.mediaType === 'image' ? `<img src="${story.media}">` : 'üé•'}
                        </div>
                        <div>${user ? user.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</div>
                        <div class="story-time">${new Date(story.time).toLocaleTimeString()}</div>
                    </div>
                `;
            });

            grid.innerHTML = html;
        }

        function viewStory(storyId) {
            const story = stories.find(s => s.id === storyId);
            if (!story) return;

            const viewer = document.createElement('div');
            viewer.className = 'story-viewer';
            viewer.innerHTML = `
                <div class="story-viewer-content">
                    <div class="story-viewer-header">
                        <div class="avatar" style="width: 40px; height: 40px;">
                            ${story.authorAvatar ? `<img src="${story.authorAvatar}">` : story.author[0]}
                        </div>
                        <div>
                            <strong style="color:white;">${story.author}</strong>
                            <div style="color:rgba(255,255,255,0.7); font-size:12px;">${story.time}</div>
                        </div>
                    </div>
                    <span class="story-viewer-close" onclick="this.closest('.story-viewer').remove()">&times;</span>
                    <div class="story-progress-bar" id="storyProgress" style="width:0%"></div>
                    ${story.mediaType === 'image' 
                        ? `<img src="${story.media}" class="story-viewer-media">` 
                        : `<video src="${story.media}" class="story-viewer-media" controls autoplay></video>`}
                </div>
            `;

            document.body.appendChild(viewer);

            if (story.mediaType === 'image') {
                let width = 0;
                const interval = setInterval(() => {
                    width += 2;
                    document.getElementById('storyProgress').style.width = width + '%';
                    if (width >= 100) {
                        clearInterval(interval);
                        viewer.remove();
                    }
                }, 100);
            }

            viewer.onclick = (e) => {
                if (e.target === viewer) viewer.remove();
            };
        }

        // ========== –ò–ì–†–´ ==========
        // –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏
        let ticTacToeBoard = ['', '', '', '', '', '', '', '', ''];
        let ticTacToeCurrentPlayer = 'X';
        let ticTacToeGameOver = false;

        function initTicTacToe() {
            ticTacToeBoard = ['', '', '', '', '', '', '', '', ''];
            ticTacToeCurrentPlayer = 'X';
            ticTacToeGameOver = false;
            renderTicTacToe();
        }

        function renderTicTacToe() {
            const grid = document.getElementById('ttc-grid');
            if (!grid) return;
            grid.innerHTML = '';
            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('div');
                cell.className = 'ttt-cell';
                cell.textContent = ticTacToeBoard[i];
                cell.onclick = () => ticTacToeMove(i);
                grid.appendChild(cell);
            }
            document.getElementById('ttc-status').textContent = ticTacToeGameOver 
                ? '–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞' 
                : `–•–æ–¥: ${ticTacToeCurrentPlayer}`;
        }

        function ticTacToeMove(index) {
            if (ticTacToeGameOver || ticTacToeBoard[index] !== '') return;
            ticTacToeBoard[index] = ticTacToeCurrentPlayer;
            const winner = checkTicTacToeWinner();
            if (winner) {
                ticTacToeGameOver = true;
                alert(`–ü–æ–±–µ–¥–∏–ª ${winner}!`);
            } else if (!ticTacToeBoard.includes('')) {
                ticTacToeGameOver = true;
                alert('–ù–∏—á—å—è!');
            } else {
                ticTacToeCurrentPlayer = ticTacToeCurrentPlayer === 'X' ? 'O' : 'X';
            }
            renderTicTacToe();
        }

        function checkTicTacToeWinner() {
            const lines = [
                [0,1,2],[3,4,5],[6,7,8],
                [0,3,6],[1,4,7],[2,5,8],
                [0,4,8],[2,4,6]
            ];
            for (let line of lines) {
                const [a,b,c] = line;
                if (ticTacToeBoard[a] && ticTacToeBoard[a] === ticTacToeBoard[b] && ticTacToeBoard[a] === ticTacToeBoard[c]) {
                    return ticTacToeBoard[a];
                }
            }
            return null;
        }

        function resetTicTacToe() {
            initTicTacToe();
        }

        // –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ
        let secretNumber = Math.floor(Math.random() * 100) + 1;
        let attempts = 0;

        function resetGuessGame() {
            secretNumber = Math.floor(Math.random() * 100) + 1;
            attempts = 0;
            document.getElementById('guess-input').value = '';
            document.getElementById('guess-hint').textContent = '';
        }

        function checkGuess() {
            const guess = parseInt(document.getElementById('guess-input').value);
            if (isNaN(guess) || guess < 1 || guess > 100) {
                alert('–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 100!');
                return;
            }
            attempts++;
            if (guess === secretNumber) {
                document.getElementById('guess-hint').textContent = `–ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –¢—ã —É–≥–∞–¥–∞–ª —á–∏—Å–ª–æ ${secretNumber} –∑–∞ ${attempts} –ø–æ–ø—ã—Ç–æ–∫!`;
                resetGuessGame();
            } else if (guess < secretNumber) {
                document.getElementById('guess-hint').textContent = '–ó–∞–≥–∞–¥–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ –±–æ–ª—å—à–µ';
            } else {
                document.getElementById('guess-hint').textContent = '–ó–∞–≥–∞–¥–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ –º–µ–Ω—å—à–µ';
            }
        }

        // –ö–∞–º–µ–Ω—å-–Ω–æ–∂–Ω–∏—Ü—ã-–±—É–º–∞–≥–∞
        function playRPS(playerChoice) {
            const choices = ['–∫–∞–º–µ–Ω—å', '–Ω–æ–∂–Ω–∏—Ü—ã', '–±—É–º–∞–≥–∞'];
            const computerChoice = choices[Math.floor(Math.random() * 3)];
            let result;
            if (playerChoice === computerChoice) {
                result = '–ù–∏—á—å—è!';
            } else if (
                (playerChoice === '–∫–∞–º–µ–Ω—å' && computerChoice === '–Ω–æ–∂–Ω–∏—Ü—ã') ||
                (playerChoice === '–Ω–æ–∂–Ω–∏—Ü—ã' && computerChoice === '–±—É–º–∞–≥–∞') ||
                (playerChoice === '–±—É–º–∞–≥–∞' && computerChoice === '–∫–∞–º–µ–Ω—å')
            ) {
                result = '–¢—ã –≤—ã–∏–≥—Ä–∞–ª! üéâ';
            } else {
                result = '–ö–æ–º–ø—å—é—Ç–µ—Ä –≤—ã–∏–≥—Ä–∞–ª! üò¢';
            }
            document.getElementById('rps-result').innerHTML = `
                –¢—ã –≤—ã–±—Ä–∞–ª: ${playerChoice}<br>
                –ö–æ–º–ø—å—é—Ç–µ—Ä –≤—ã–±—Ä–∞–ª: ${computerChoice}<br>
                <strong>${result}</strong>
            `;
        }

        // –ò–≥—Ä–∞ –Ω–∞ –ø–∞–º—è—Ç—å
        let memoryCards = [];
        let flippedCards = [];
        let matchedCards = [];
        let moves = 0;

        function initMemoryGame() {
            const symbols = ['üê∂', 'üê±', 'üê≠', 'üêπ', 'üê∞', 'ü¶ä', 'üêª', 'üêº'];
            let deck = [...symbols, ...symbols];
            deck = shuffleArray(deck);
            memoryCards = deck.map((symbol, index) => ({ id: index, symbol, flipped: false, matched: false }));
            flippedCards = [];
            matchedCards = [];
            moves = 0;
            renderMemoryGame();
        }

        function shuffleArray(arr) {
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function renderMemoryGame() {
            const grid = document.getElementById('memory-grid');
            if (!grid) return;
            grid.innerHTML = '';
            memoryCards.forEach(card => {
                const cardDiv = document.createElement('div');
                cardDiv.className = `memory-card ${card.matched ? 'matched' : ''} ${card.flipped ? 'flipped' : ''}`;
                cardDiv.textContent = card.flipped || card.matched ? card.symbol : '?';
                cardDiv.onclick = () => flipCard(card.id);
                grid.appendChild(cardDiv);
            });
            document.getElementById('memory-moves').textContent = `–•–æ–¥–æ–≤: ${moves}`;
        }

        function flipCard(id) {
            if (flippedCards.length === 2) return;
            const card = memoryCards.find(c => c.id === id);
            if (card.matched || card.flipped) return;

            card.flipped = true;
            flippedCards.push(card);
            renderMemoryGame();

            if (flippedCards.length === 2) {
                moves++;
                if (flippedCards[0].symbol === flippedCards[1].symbol) {
                    flippedCards[0].matched = true;
                    flippedCards[1].matched = true;
                    flippedCards = [];
                } else {
                    setTimeout(() => {
                        flippedCards.forEach(c => c.flipped = false);
                        flippedCards = [];
                        renderMemoryGame();
                    }, 1000);
                }
                renderMemoryGame();
            }
        }

        // –ó–º–µ–π–∫–∞
        let snakeGame;

        function initSnake() {
            const boardSize = 15;
            snakeGame = {
                board: Array(boardSize).fill().map(() => Array(boardSize).fill(0)),
                snake: [{x: 7, y: 7}],
                direction: 'right',
                food: {x: 5, y: 5},
                score: 0,
                gameOver: false,
                interval: null
            };
            placeFood();
            renderSnake();
        }

        function placeFood() {
            if (!snakeGame) return;
            let freeCells = [];
            for (let i = 0; i < 15; i++) {
                for (let j = 0; j < 15; j++) {
                    if (!snakeGame.snake.some(s => s.x === i && s.y === j)) {
                        freeCells.push({x: i, y: j});
                    }
                }
            }
            if (freeCells.length === 0) {
                snakeGame.gameOver = true;
                alert('–¢—ã –≤—ã–∏–≥—Ä–∞–ª! –ó–º–µ–π–∫–∞ –∑–∞–ø–æ–ª–Ω–∏–ª–∞ –≤—Å—ë –ø–æ–ª–µ.');
                return;
            }
            const rand = Math.floor(Math.random() * freeCells.length);
            snakeGame.food = freeCells[rand];
        }

        function renderSnake() {
            const boardEl = document.getElementById('snake-board');
            if (!boardEl) return;
            boardEl.innerHTML = '';
            for (let i = 0; i < 15; i++) {
                for (let j = 0; j < 15; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'snake-cell';
                    if (snakeGame.snake.some(s => s.x === i && s.y === j)) {
                        cell.classList.add('snake');
                    }
                    if (snakeGame.food && snakeGame.food.x === i && snakeGame.food.y === j) {
                        cell.classList.add('food');
                    }
                    boardEl.appendChild(cell);
                }
            }
            document.getElementById('snake-score').textContent = `–°—á—ë—Ç: ${snakeGame.score}`;
        }

        function moveSnake() {
            if (!snakeGame || snakeGame.gameOver) return;
            const head = {...snakeGame.snake[0]};
            switch (snakeGame.direction) {
                case 'right': head.y++; break;
                case 'left': head.y--; break;
                case 'up': head.x--; break;
                case 'down': head.x++; break;
            }
            if (head.x < 0 || head.x >= 15 || head.y < 0 || head.y >= 15) {
                snakeGame.gameOver = true;
                alert('–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –¢—ã –≤—Ä–µ–∑–∞–ª—Å—è –≤ —Å—Ç–µ–Ω—É.');
                clearInterval(snakeGame.interval);
                return;
            }
            if (snakeGame.snake.some(s => s.x === head.x && s.y === head.y)) {
                snakeGame.gameOver = true;
                alert('–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –¢—ã –≤—Ä–µ–∑–∞–ª—Å—è –≤ —Å–µ–±—è.');
                clearInterval(snakeGame.interval);
                return;
            }
            snakeGame.snake.unshift(head);
            if (head.x === snakeGame.food.x && head.y === snakeGame.food.y) {
                snakeGame.score++;
                placeFood();
            } else {
                snakeGame.snake.pop();
            }
            renderSnake();
        }

        function resetSnake() {
            if (snakeGame && snakeGame.interval) clearInterval(snakeGame.interval);
            initSnake();
            snakeGame.interval = setInterval(() => moveSnake(), 200);
        }

        document.addEventListener('keydown', (e) => {
            if (!snakeGame || snakeGame.gameOver) return;
            const key = e.key;
            if (key.startsWith('Arrow')) e.preventDefault();
            if (key === 'ArrowUp' && snakeGame.direction !== 'down') snakeGame.direction = 'up';
            else if (key === 'ArrowDown' && snakeGame.direction !== 'up') snakeGame.direction = 'down';
            else if (key === 'ArrowLeft' && snakeGame.direction !== 'right') snakeGame.direction = 'left';
            else if (key === 'ArrowRight' && snakeGame.direction !== 'left') snakeGame.direction = 'right';
        });

        // ========== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ==========
        function addNotification(userId, type, fromId, text) {
            const notification = {
                id: Date.now(),
                userId: userId,
                type: type,
                from: fromId,
                text: text,
                read: false,
                time: new Date().toLocaleString()
            };
            notifications.push(notification);
            saveAll();
            updateNotifications();
        }

        function toggleNotifications() {
            const panel = document.getElementById('notificationsPanel');
            panel.classList.toggle('active');
            if (panel.classList.contains('active')) {
                updateNotifications();
            }
        }

        function markNotificationRead(id) {
            const notif = notifications.find(n => n.id === id);
            if (notif) {
                notif.read = true;
                saveAll();
                updateNotifications();
            }
        }

        function updateNotifications() {
            const userNotifications = notifications.filter(n => n.userId === currentUser.id).sort((a, b) => b.id - a.id);
            const list = document.getElementById('notificationsList');
            const unreadCount = userNotifications.filter(n => !n.read).length;

            document.getElementById('notificationBadge').style.display = unreadCount ? 'block' : 'none';
            document.getElementById('notificationBadge').textContent = unreadCount;

            if (userNotifications.length === 0) {
                list.innerHTML = '<p style="text-align: center; padding: 30px; color: var(--gray);">–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</p>';
                return;
            }

            list.innerHTML = userNotifications.map(n => {
                const fromUser = users.find(u => u.id === n.from);
                
                if (n.type === 'friend_request' && n.userId === currentUser.id) {
                    const request = friendRequests.find(r => r.from === n.from && r.to === currentUser.id);
                    if (request) {
                        return `
                            <div class="notification-item ${!n.read ? 'unread' : ''}" onclick="markNotificationRead(${n.id})">
                                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                                    <div class="avatar" style="width: 40px; height: 40px;">
                                        ${fromUser?.avatar ? `<img src="${fromUser.avatar}">` : (fromUser ? (fromUser.name[0] + fromUser.surname[0]).toUpperCase() : '?')}
                                    </div>
                                    <div>
                                        <strong>${fromUser ? fromUser.name + ' ' + fromUser.surname : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</strong>
                                    </div>
                                </div>
                                <div>${n.text}</div>
                                <div class="friend-request-actions">
                                    <button class="accept-btn" onclick="event.stopPropagation(); acceptFriendRequest(${request.id})">–ü—Ä–∏–Ω—è—Ç—å</button>
                                    <button class="decline-btn" onclick="event.stopPropagation(); declineFriendRequest(${request.id})">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                                </div>
                                <div class="notification-time">${n.time}</div>
                            </div>
                        `;
                    }
                }
                return `
                    <div class="notification-item ${!n.read ? 'unread' : ''}" onclick="markNotificationRead(${n.id})">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div class="avatar" style="width: 40px; height: 40px;">
                                ${fromUser?.avatar ? `<img src="${fromUser.avatar}">` : (fromUser ? (fromUser.name[0] + fromUser.surname[0]).toUpperCase() : 'S')}
                            </div>
                            <div>
                                <strong>${fromUser ? fromUser.name + ' ' + fromUser.surname : '–°–∏—Å—Ç–µ–º–∞'}</strong>
                                <div style="color: var(--gray);">${n.text}</div>
                                <div class="notification-time">${n.time}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ========== –î–†–£–ó–¨–Ø ==========
        function sendFriendRequest(userId) {
            if (friendRequests.some(r => r.from === currentUser.id && r.to === userId)) {
                alert('–ó–∞—è–≤–∫–∞ —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!');
                return;
            }

            const request = {
                id: Date.now(),
                from: currentUser.id,
                to: userId,
                status: 'pending',
                time: new Date().toLocaleString()
            };
            friendRequests.push(request);
            
            addNotification(userId, 'friend_request', currentUser.id, 
                `${currentUser.name} ${currentUser.surname} —Ö–æ—á–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –≤–∞—Å –≤ –¥—Ä—É–∑—å—è`);

            saveAll();
            alert('–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!');
        }

        function acceptFriendRequest(requestId) {
            const request = friendRequests.find(r => r.id === requestId);
            if (!request) return;

            request.status = 'accepted';
            
            const fromUser = users.find(u => u.id === request.from);
            const toUser = users.find(u => u.id === request.to);

            if (fromUser && toUser) {
                if (!fromUser.friends) fromUser.friends = [];
                if (!toUser.friends) toUser.friends = [];
                
                fromUser.friends.push(toUser.id);
                toUser.friends.push(fromUser.id);

                addNotification(request.from, 'friend_accepted', request.to,
                    `${toUser.name} ${toUser.surname} –ø—Ä–∏–Ω—è–ª(–∞) –≤–∞—à—É –∑–∞—è–≤–∫—É –≤ –¥—Ä—É–∑—å—è`);

                notifications = notifications.filter(n => 
                    !(n.type === 'friend_request' && n.from === request.from && n.userId === request.to)
                );
            }

            friendRequests = friendRequests.filter(r => r.id !== requestId);
            saveAll();
            updateNotifications();
            if (document.getElementById('friendsPage').style.display === 'block') {
                renderFriends();
            }
        }

        function declineFriendRequest(requestId) {
            friendRequests = friendRequests.filter(r => r.id !== requestId);
            notifications = notifications.filter(n => n.type !== 'friend_request' || n.id !== requestId);
            saveAll();
            updateNotifications();
        }

        function removeFriend(userId) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –∏–∑ –¥—Ä—É–∑–µ–π?')) {
                currentUser.friends = currentUser.friends.filter(id => id !== userId);
                const friend = users.find(u => u.id === userId);
                if (friend) {
                    friend.friends = friend.friends.filter(id => id !== currentUser.id);
                }
                saveAll();
                showMyProfile();
            }
        }

        // ========== –°–û–û–ë–©–ï–ù–ò–Ø ==========
        function startChat(userId) {
            const chatId = [currentUser.id, userId].sort().join('_');
            let chat = messages.find(m => m.id === chatId);

            if (!chat) {
                chat = {
                    id: chatId,
                    participants: [currentUser.id, userId],
                    messages: []
                };
                messages.push(chat);
                saveAll();
            }

            showMessages();
            openChat(chatId);
        }

        function updateChats() {
            const list = document.getElementById('chatsList');
            const userChats = messages.filter(m => m.participants.includes(currentUser.id));

            if (userChats.length === 0) {
                list.innerHTML = '<p style="text-align: center; padding: 30px; color: var(--gray);">–ù–µ—Ç —á–∞—Ç–æ–≤</p>';
                return;
            }

            list.innerHTML = userChats.map(chat => {
                const otherId = chat.participants.find(id => id !== currentUser.id);
                const other = users.find(u => u.id === otherId);
                const lastMsg = chat.messages[chat.messages.length - 1];

                return `
                    <div class="chat-item" onclick="openChat('${chat.id}')">
                        <div class="chat-avatar">
                            ${other?.avatar ? `<img src="${other.avatar}">` : (other ? (other.name[0] + other.surname[0]).toUpperCase() : '?')}
                        </div>
                        <div class="chat-info">
                            <div class="chat-name">
                                ${other ? other.name + ' ' + other.surname : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}
                                ${other?.isVerified ? '<span class="verified-badge-small">‚úì</span>' : ''}
                            </div>
                            <div class="last-message">
                                ${lastMsg ? (lastMsg.media ? 'üì∑ –§–æ—Ç–æ' : (lastMsg.text?.substring(0, 30) + (lastMsg.text?.length > 30 ? '...' : ''))) : '–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π'}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function openChat(chatId) {
            const chat = messages.find(m => m.id === chatId);
            if (!chat) return;

            const otherId = chat.participants.find(id => id !== currentUser.id);
            const other = users.find(u => u.id === otherId);

            document.getElementById('currentChatAvatar').innerHTML = other?.avatar ? `<img src="${other.avatar}">` : (other ? (other.name[0] + other.surname[0]).toUpperCase() : '?');
            document.getElementById('currentChatName').textContent = other ? other.name + ' ' + other.surname : '–ß–∞—Ç';
            document.getElementById('messageInputArea').style.display = 'flex';
            document.getElementById('messageInputArea').dataset.chatId = chatId;

            document.getElementById('messagesList').innerHTML = chat.messages.map(msg => {
                const isOutgoing = msg.from === currentUser.id;
                const sender = users.find(u => u.id === msg.from);
                return `
                    <div class="message ${isOutgoing ? 'outgoing' : ''}">
                        <div class="message-content">
                            ${!isOutgoing ? `<strong>${sender?.name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</strong><br>` : ''}
                            ${msg.media ? `<img src="${msg.media}" class="message-media" onclick="viewImage('${msg.media}')"><br>` : ''}
                            ${msg.text ? msg.text : ''}
                            <div class="message-time">${msg.time}</div>
                        </div>
                    </div>
                `;
            }).join('');

            document.getElementById('messagesList').scrollTop = document.getElementById('messagesList').scrollHeight;
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const chatId = document.getElementById('messageInputArea').dataset.chatId;
            const text = input.value.trim();

            if (!text || !chatId) return;

            const chat = messages.find(m => m.id === chatId);
            if (!chat) return;

            const otherId = chat.participants.find(id => id !== currentUser.id);

            chat.messages.push({
                from: currentUser.id,
                text: text,
                time: new Date().toLocaleString()
            });

            addNotification(otherId, 'message', currentUser.id, 
                `${currentUser.name} ${currentUser.surname}: ${text.substring(0, 50)}${text.length > 50 ? '...' : ''}`);

            saveAll();
            input.value = '';
            openChat(chatId);
        }

        function sendMessageWithFile() {
            const file = document.getElementById('messageFile').files[0];
            const chatId = document.getElementById('messageInputArea').dataset.chatId;

            if (!file || !chatId) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const chat = messages.find(m => m.id === chatId);
                if (chat) {
                    const otherId = chat.participants.find(id => id !== currentUser.id);
                    
                    chat.messages.push({
                        from: currentUser.id,
                        media: e.target.result,
                        time: new Date().toLocaleString()
                    });

                    addNotification(otherId, 'message', currentUser.id, 
                        `${currentUser.name} ${currentUser.surname} –æ—Ç–ø—Ä–∞–≤–∏–ª(–∞) —Ñ–æ—Ç–æ`);

                    saveAll();
                    openChat(chatId);
                }
            };
            reader.readAsDataURL(file);
        }

        // ========== –ü–û–°–¢–´ ==========
        function openPostModal() {
            openModal('postModal');
        }

        function createPost() {
            const text = document.getElementById('postText').value;
            const mediaFile = document.getElementById('postMedia').files[0];

            if (!text && !mediaFile) {
                alert('–ù–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –º–µ–¥–∏–∞!');
                return;
            }

            const process = (mediaData) => {
                const newPost = {
                    id: Date.now(),
                    userId: currentUser.id,
                    author: `${currentUser.name} ${currentUser.surname}`,
                    authorTag: currentUser.tag,
                    authorAvatar: currentUser.avatar,
                    text: text,
                    media: mediaData,
                    mediaType: mediaFile ? (mediaFile.type.startsWith('image/') ? 'image' : 'video') : null,
                    time: new Date().toLocaleString(),
                    likes: [],
                    comments: []
                };

                posts.unshift(newPost);
                saveAll();
                closeModal('postModal');
                updateFeed();
            };

            if (mediaFile) {
                const reader = new FileReader();
                reader.onload = (e) => process(e.target.result);
                reader.readAsDataURL(mediaFile);
            } else {
                process(null);
            }
        }

        function likePost(postId) {
            const post = posts.find(p => p.id === postId);
            if (!post) return;

            const index = post.likes.indexOf(currentUser.id);
            if (index === -1) {
                post.likes.push(currentUser.id);
                addNotification(post.userId, 'like', currentUser.id,
                    `${currentUser.name} ${currentUser.surname} –æ—Ü–µ–Ω–∏–ª(–∞) –≤–∞—à—É –∑–∞–ø–∏—Å—å`);
            } else {
                post.likes.splice(index, 1);
            }
            saveAll();
            updateFeed();
        }

        function showComments(postId) {
            const el = document.getElementById(`comments-${postId}`);
            el.style.display = el.style.display === 'none' ? 'block' : 'none';
        }

        function addComment(postId) {
            const input = document.getElementById(`comment-${postId}`);
            const text = input.value.trim();
            if (!text) return;

            const post = posts.find(p => p.id === postId);
            if (!post) return;

            post.comments.push({
                author: `${currentUser.name} ${currentUser.surname}`,
                avatar: currentUser.avatar,
                text: text,
                time: new Date().toLocaleString()
            });

            addNotification(post.userId, 'comment', currentUser.id,
                `${currentUser.name} ${currentUser.surname} –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª(–∞) –≤–∞—à—É –∑–∞–ø–∏—Å—å: "${text.substring(0, 30)}..."`);

            saveAll();
            updateFeed();
        }

        function updateFeed() {
            const feed = document.getElementById('postsFeed');
            if (!feed) return;
            
            const visiblePosts = posts.filter(post => {
                const author = users.find(u => u.id === post.userId);
                if (!author) return false;
                return !author.isPrivate || author.friends?.includes(currentUser.id) || author.id === currentUser.id;
            });

            if (visiblePosts.length === 0) {
                feed.innerHTML = '<p style="text-align: center; padding: 50px; color: var(--gray);">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</p>';
                return;
            }

            feed.innerHTML = visiblePosts.map(post => {
                const author = users.find(u => u.id === post.userId);
                const isLiked = post.likes.includes(currentUser.id);
                
                return `
                    <div class="post">
                        <div class="post-header" onclick="showUserProfile(${post.userId})">
                            <div class="avatar">
                                ${author?.avatar ? `<img src="${author.avatar}">` : (author ? (author.name[0] + author.surname[0]).toUpperCase() : '?')}
                            </div>
                            <div>
                                <div class="post-author">
                                    ${post.author}
                                    ${author?.isMasterAdmin ? '<span class="admin-badge-small">MASTER</span>' : author?.isAdmin ? '<span class="admin-badge-small">ADMIN</span>' : ''}
                                    ${author?.isVerified ? '<span class="verified-badge-small">‚úì</span>' : ''}
                                </div>
                                <div class="post-time">${post.time}</div>
                            </div>
                        </div>
                        <div class="post-content">${post.text}</div>
                        ${post.media ? `
                            <div class="post-media">
                                ${post.mediaType === 'image' 
                                    ? `<img src="${post.media}" onclick="viewImage('${post.media}')">` 
                                    : `<video src="${post.media}" controls></video>`}
                            </div>
                        ` : ''}
                        <div class="post-stats">
                            <span>‚ù§Ô∏è ${post.likes.length}</span>
                            <span>üí¨ ${post.comments.length}</span>
                        </div>
                        <div class="post-actions">
                            <div class="post-action ${isLiked ? 'liked' : ''}" onclick="likePost(${post.id})">
                                ‚ù§Ô∏è –ù—Ä–∞–≤–∏—Ç—Å—è
                            </div>
                            <div class="post-action" onclick="showComments(${post.id})">
                                üí¨ –ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å
                            </div>
                        </div>
                        <div id="comments-${post.id}" class="comments-section" style="display: none;">
                            ${post.comments.map(c => `
                                <div class="comment">
                                    <div class="avatar" style="width: 35px; height: 35px;">
                                        ${c.avatar ? `<img src="${c.avatar}">` : (c.author[0] + (c.author.split(' ')[1]?.[0] || '')).toUpperCase()}
                                    </div>
                                    <div class="comment-content">
                                        <div class="comment-author">${c.author}</div>
                                        <div>${c.text}</div>
                                    </div>
                                </div>
                            `).join('')}
                            <div class="comment-input">
                                <input type="text" id="comment-${post.id}" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π...">
                                <button onclick="addComment(${post.id})">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ========== –ü–†–û–§–ò–õ–¨ ==========
        function showMyProfile() {
            showUserProfile(currentUser.id);
        }

        function showUserProfile(userId) {
            hideAllPages();
            document.getElementById('profilePage').style.display = 'block';
            document.querySelectorAll('.menu-item')[1].classList.add('active');
            renderProfile(userId);
        }

        function renderProfile(userId) {
            const user = users.find(u => u.id === userId);
            if (!user) return;

            const isOwnProfile = currentUser.id === userId;
            const isFriend = user.friends?.includes(currentUser.id);
            const hasRequest = friendRequests.some(r => r.from === currentUser.id && r.to === userId && r.status === 'pending');
            const userPosts = posts.filter(p => p.userId === userId);

            let html = `
                <div class="profile-header">
                    <div class="profile-cover">
                        <div class="profile-avatar-large">
                            ${user.avatar ? `<img src="${user.avatar}">` : (user.name[0] + user.surname[0]).toUpperCase()}
                        </div>
                    </div>
                    <div class="profile-info">
                        <div class="profile-name">
                            ${user.name} ${user.surname}
                            ${user.isMasterAdmin ? '<span class="admin-badge">MASTER ADMIN</span>' : user.isAdmin ? '<span class="admin-badge">ADMIN</span>' : ''}
                            ${user.isVerified ? '<span class="verified-badge">‚úì</span>' : ''}
                        </div>
                        <div class="profile-tag">${user.tag}</div>
                        <div class="profile-stats">
                            <div class="profile-stat">
                                <div class="profile-stat-value">${userPosts.length}</div>
                                <div class="profile-stat-label">–ø–æ—Å—Ç–æ–≤</div>
                            </div>
                            <div class="profile-stat">
                                <div class="profile-stat-value">${user.friends?.length || 0}</div>
                                <div class="profile-stat-label">–¥—Ä—É–∑–µ–π</div>
                            </div>
                        </div>
                        <div class="profile-actions">
            `;

            if (isOwnProfile) {
                html += `
                    <button class="profile-btn primary" onclick="openModal('editProfileModal')">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                `;
            } else {
                if (isFriend) {
                    html += `<button class="profile-btn secondary" onclick="removeFriend(${userId})">–£–¥–∞–ª–∏—Ç—å –∏–∑ –¥—Ä—É–∑–µ–π</button>`;
                } else if (hasRequest) {
                    html += `<button class="profile-btn secondary" disabled>–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞</button>`;
                } else {
                    html += `<button class="profile-btn primary" onclick="sendFriendRequest(${userId})">–î–æ–±–∞–≤–∏—Ç—å –≤ –¥—Ä—É–∑—å—è</button>`;
                }
                html += `<button class="profile-btn secondary" onclick="startChat(${userId})">–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</button>`;
            }

            html += `
                        </div>
                    </div>
                </div>
                <div id="userPosts"></div>
            `;

            document.getElementById('profilePage').innerHTML = html;

            let postsHtml = '<h3 style="margin: 30px 0 20px;">–ó–∞–ø–∏—Å–∏</h3>';
            if (userPosts.length === 0) {
                postsHtml += '<p style="text-align: center; color: var(--gray);">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</p>';
            } else {
                userPosts.forEach(post => {
                    postsHtml += `
                        <div class="post">
                            <div class="post-header">
                                <div class="avatar">
                                    ${post.authorAvatar ? `<img src="${post.authorAvatar}">` : (post.author[0] + (post.author.split(' ')[1]?.[0] || '')).toUpperCase()}
                                </div>
                                <div>
                                    <div class="post-author">${post.author}</div>
                                    <div class="post-time">${post.time}</div>
                                </div>
                            </div>
                            <div class="post-content">${post.text}</div>
                            ${post.media ? `
                                <div class="post-media">
                                    ${post.mediaType === 'image' 
                                        ? `<img src="${post.media}" onclick="viewImage('${post.media}')">` 
                                        : `<video src="${post.media}" controls></video>`}
                                </div>
                            ` : ''}
                            <div class="post-stats">
                                <span>‚ù§Ô∏è ${post.likes.length}</span>
                                <span>üí¨ ${post.comments.length}</span>
                            </div>
                        </div>
                    `;
                });
            }
            document.getElementById('userPosts').innerHTML = postsHtml;
        }

        function saveProfile() {
            currentUser.name = document.getElementById('editName').value || currentUser.name;
            currentUser.surname = document.getElementById('editSurname').value || currentUser.surname;
            currentUser.tag = document.getElementById('editTag').value || currentUser.tag;

            const avatarFile = document.getElementById('editAvatar').files[0];
            if (avatarFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    currentUser.avatar = e.target.result;
                    updateUserInList();
                };
                reader.readAsDataURL(avatarFile);
            } else {
                updateUserInList();
            }
        }

        function updateUserInList() {
            const index = users.findIndex(u => u.id === currentUser.id);
            users[index] = currentUser;
            localStorage.setItem('skrip_currentUser', JSON.stringify(currentUser));
            saveAll();
            closeModal('editProfileModal');
            showMyProfile();
            updateUI();
        }

        // ========== –î–†–£–ó–¨–Ø (—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥) ==========
        function renderFriends() {
            const friends = users.filter(u => currentUser.friends?.includes(u.id));
            const pendingRequests = friendRequests.filter(r => r.to === currentUser.id && r.status === 'pending');
            
            let html = '<div style="background: white; border-radius: 15px; padding: 25px;">';
            
            if (pendingRequests.length > 0) {
                html += '<h3 style="margin-bottom: 20px;">üì® –ó–∞—è–≤–∫–∏ –≤ –¥—Ä—É–∑—å—è</h3>';
                pendingRequests.forEach(request => {
                    const fromUser = users.find(u => u.id === request.from);
                    if (fromUser) {
                        html += `
                            <div style="display: flex; align-items: center; justify-content: space-between; background: var(--vk-light); padding: 15px; border-radius: 12px; margin-bottom: 15px;">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <div class="avatar" style="width: 50px; height: 50px;">
                                        ${fromUser.avatar ? `<img src="${fromUser.avatar}">` : (fromUser.name[0] + fromUser.surname[0]).toUpperCase()}
                                    </div>
                                    <div>
                                        <strong>${fromUser.name} ${fromUser.surname}</strong>
                                        <div style="color: var(--gray);">${fromUser.tag}</div>
                                    </div>
                                </div>
                                <div>
                                    <button class="accept-btn" onclick="acceptFriendRequest(${request.id})">–ü—Ä–∏–Ω—è—Ç—å</button>
                                    <button class="decline-btn" onclick="declineFriendRequest(${request.id})">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                                </div>
                            </div>
                        `;
                    }
                });
                html += '<hr style="margin: 30px 0;">';
            }
            
            html += '<h3 style="margin-bottom: 20px;">üë• –ú–æ–∏ –¥—Ä—É–∑—å—è</h3>';
            
            if (friends.length === 0) {
                html += '<p style="text-align: center; color: var(--gray); padding: 30px;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π</p>';
            } else {
                friends.forEach(friend => {
                    html += `
                        <div style="display: flex; align-items: center; justify-content: space-between; padding: 12px; border-bottom: 1px solid var(--vk-light);">
                            <div style="display: flex; align-items: center; gap: 15px; cursor: pointer;" onclick="showUserProfile(${friend.id})">
                                <div class="avatar" style="width: 50px; height: 50px;">
                                    ${friend.avatar ? `<img src="${friend.avatar}">` : (friend.name[0] + friend.surname[0]).toUpperCase()}
                                </div>
                                <div>
                                    <strong>${friend.name} ${friend.surname}</strong>
                                    ${friend.isVerified ? '<span class="verified-badge-small">‚úì</span>' : ''}
                                    <div style="color: var(--gray);">${friend.tag}</div>
                                </div>
                            </div>
                            <div>
                                <button class="profile-btn secondary" style="padding: 8px 15px;" onclick="startChat(${friend.id})">üí¨</button>
                                <button class="profile-btn secondary" style="padding: 8px 15px;" onclick="removeFriend(${friend.id})">‚ùå</button>
                            </div>
                        </div>
                    `;
                });
            }
            
            html += '</div>';
            document.getElementById('friendsPage').innerHTML = html;
        }

        // ========== –°–û–û–ë–©–ï–°–¢–í–ê ==========
        function createCommunity() {
            const name = document.getElementById('communityName').value;
            if (!name) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞!');
                return;
            }

            const avatarFile = document.getElementById('communityAvatar').files[0];
            const process = (avatarData) => {
                const newCommunity = {
                    id: Date.now(),
                    name: name,
                    description: document.getElementById('communityDesc').value,
                    avatar: avatarData,
                    creator: currentUser.id,
                    members: [currentUser.id],
                    posts: [],
                    createdAt: new Date().toLocaleString()
                };

                communities.push(newCommunity);
                saveAll();
                closeModal('communityModal');
                showCommunities();
            };

            if (avatarFile) {
                const reader = new FileReader();
                reader.onload = (e) => process(e.target.result);
                reader.readAsDataURL(avatarFile);
            } else {
                process(null);
            }
        }

        function joinCommunity(commId) {
            const comm = communities.find(c => c.id === commId);
            if (!comm) return;

            const index = comm.members.indexOf(currentUser.id);
            if (index === -1) {
                comm.members.push(currentUser.id);
                if (!currentUser.communities) currentUser.communities = [];
                currentUser.communities.push(commId);
                
                addNotification(comm.creator, 'community_join', currentUser.id,
                    `${currentUser.name} ${currentUser.surname} –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ –≤–∞—à–µ–º—É —Å–æ–æ–±—â–µ—Å—Ç–≤—É "${comm.name}"`);
            } else {
                comm.members.splice(index, 1);
                if (currentUser.communities) {
                    currentUser.communities = currentUser.communities.filter(id => id !== commId);
                }
            }
            saveAll();
            if (document.getElementById('communitiesPage').style.display === 'block') {
                renderCommunities();
            }
        }

        function createCommunityPost(commId) {
            const comm = communities.find(c => c.id === commId);
            if (!comm) return;

            const text = prompt('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞:');
            if (!text) return;

            const post = {
                id: Date.now(),
                author: `${currentUser.name} ${currentUser.surname}`,
                text: text,
                time: new Date().toLocaleString(),
                likes: [],
                comments: []
            };

            comm.posts.push(post);
            saveAll();
            openCommunity(commId);
        }

        function openCommunity(commId) {
            const comm = communities.find(c => c.id === commId);
            if (!comm) return;

            const isMember = comm.members.includes(currentUser.id);
            const creator = users.find(u => u.id === comm.creator);

            let html = `
                <div class="community-page">
                    <div class="community-header">
                        <div class="community-avatar-large">
                            ${comm.avatar ? `<img src="${comm.avatar}">` : 'üè¢'}
                        </div>
                        <div class="community-info">
                            <h1 class="community-title">${comm.name}</h1>
                            <p class="community-description">${comm.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
                            <div style="display: flex; gap: 30px;">
                                <div><strong>${comm.members.length}</strong> —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
                                <div><strong>${comm.posts.length}</strong> –ø–æ—Å—Ç–æ–≤</div>
                            </div>
                            <div class="community-actions">
                                ${isMember ? `
                                    <button class="profile-btn primary" onclick="createCommunityPost(${comm.id})">‚ûï –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç</button>
                                    <button class="profile-btn secondary" onclick="joinCommunity(${comm.id})">‚úì –í—ã —É—á–∞—Å—Ç–Ω–∏–∫</button>
                                ` : `
                                    <button class="profile-btn primary" onclick="joinCommunity(${comm.id})">–í—Å—Ç—É–ø–∏—Ç—å</button>
                                `}
                                ${currentUser?.isAdmin ? `
                                    <button class="admin-btn delete" onclick="deleteCommunity(${comm.id})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ</button>
                                ` : ''}
                            </div>
                            <p style="margin-top: 15px; color: var(--gray);">–°–æ–∑–¥–∞—Ç–µ–ª—å: ${creator ? creator.name + ' ' + creator.surname : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</p>
                        </div>
                    </div>
                    <div class="community-posts">
                        <h3 style="margin-bottom: 20px;">–ü–æ—Å—Ç—ã</h3>
                        ${comm.posts.length === 0 ? '<p style="color: var(--gray);">–ù–µ—Ç –ø–æ—Å—Ç–æ–≤</p>' : ''}
                        ${comm.posts.map(post => `
                            <div class="post">
                                <div class="post-header">
                                    <div class="avatar">
                                        ${comm.avatar ? `<img src="${comm.avatar}">` : 'üè¢'}
                                    </div>
                                    <div>
                                        <div class="post-author">${post.author}</div>
                                        <div class="post-time">${post.time}</div>
                                    </div>
                                </div>
                                <div class="post-content">${post.text}</div>
                                <div class="post-stats">
                                    <span>‚ù§Ô∏è ${post.likes.length}</span>
                                    <span>üí¨ ${post.comments.length}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            document.getElementById('communitiesPage').innerHTML = html;
        }

        function renderCommunities() {
            let html = `
                <div style="background: white; border-radius: 15px; padding: 25px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h2>–°–æ–æ–±—â–µ—Å—Ç–≤–∞</h2>
                        <button class="auth-btn" style="width: auto; padding: 10px 20px;" onclick="openModal('communityModal')">+ –°–æ–∑–¥–∞—Ç—å</button>
                    </div>
                    <div class="communities-grid" id="communitiesGrid"></div>
                </div>
            `;
            document.getElementById('communitiesPage').innerHTML = html;

            const grid = document.getElementById('communitiesGrid');
            if (communities.length === 0) {
                grid.innerHTML = '<p style="text-align: center; padding: 50px; color: var(--gray);">–ù–µ—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤</p>';
                return;
            }

            grid.innerHTML = communities.map(comm => {
                const isMember = comm.members.includes(currentUser.id);
                return `
                    <div class="community-card" onclick="openCommunity(${comm.id})">
                        <div class="community-avatar">
                            ${comm.avatar ? `<img src="${comm.avatar}">` : 'üè¢'}
                        </div>
                        <div class="community-name">${comm.name}</div>
                        <div class="community-members">üë• ${comm.members.length} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
                        <button class="community-join-btn ${isMember ? 'joined' : ''}" onclick="event.stopPropagation(); joinCommunity(${comm.id})">
                            ${isMember ? '–í—ã —É—á–∞—Å—Ç–Ω–∏–∫' : '–í—Å—Ç—É–ø–∏—Ç—å'}
                        </button>
                    </div>
                `;
            }).join('');
        }

        // ========== –ö–ê–ù–ê–õ–´ ==========
        function createChannel() {
            const name = document.getElementById('channelName').value;
            if (!name) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞!');
                return;
            }

            const avatarFile = document.getElementById('channelAvatar').files[0];
            const process = (avatarData) => {
                const newChannel = {
                    id: Date.now(),
                    name: name,
                    description: document.getElementById('channelDesc').value,
                    avatar: avatarData,
                    creator: currentUser.id,
                    subscribers: [currentUser.id],
                    posts: [],
                    createdAt: new Date().toLocaleString()
                };

                channels.push(newChannel);
                saveAll();
                closeModal('channelModal');
                showChannels();
            };

            if (avatarFile) {
                const reader = new FileReader();
                reader.onload = (e) => process(e.target.result);
                reader.readAsDataURL(avatarFile);
            } else {
                process(null);
            }
        }

        function subscribeChannel(channelId) {
            const channel = channels.find(c => c.id === channelId);
            if (!channel) return;

            const index = channel.subscribers.indexOf(currentUser.id);
            if (index === -1) {
                channel.subscribers.push(currentUser.id);
                if (!currentUser.channels) currentUser.channels = [];
                currentUser.channels.push(channelId);
                
                addNotification(channel.creator, 'channel_subscribe', currentUser.id,
                    `${currentUser.name} ${currentUser.surname} –ø–æ–¥–ø–∏—Å–∞–ª—Å—è –Ω–∞ –≤–∞—à –∫–∞–Ω–∞–ª "${channel.name}"`);
            } else {
                channel.subscribers.splice(index, 1);
                if (currentUser.channels) {
                    currentUser.channels = currentUser.channels.filter(id => id !== channelId);
                }
            }
            saveAll();
            if (document.getElementById('channelsPage').style.display === 'block') {
                renderChannels();
            }
        }

        function createChannelPost(channelId) {
            const channel = channels.find(c => c.id === channelId);
            if (!channel) return;

            const text = prompt('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞:');
            if (!text) return;

            const post = {
                id: Date.now(),
                text: text,
                time: new Date().toLocaleString()
            };

            channel.posts.push(post);
            saveAll();

            channel.subscribers.forEach(subId => {
                if (subId !== currentUser.id) {
                    addNotification(subId, 'channel_post', currentUser.id,
                        `–ù–æ–≤—ã–π –ø–æ—Å—Ç –≤ –∫–∞–Ω–∞–ª–µ "${channel.name}"`);
                }
            });

            openChannel(channel.id);
        }

        function openChannel(channelId) {
            const channel = channels.find(c => c.id === channelId);
            if (!channel) return;

            const isSubscribed = channel.subscribers.includes(currentUser.id);
            const creator = users.find(u => u.id === channel.creator);

            let html = `
                <div class="channel-page">
                    <div class="channel-header">
                        <div style="display: flex; align-items: center; gap: 30px;">
                            <div class="community-avatar-large">
                                ${channel.avatar ? `<img src="${channel.avatar}">` : 'üì¢'}
                            </div>
                            <div style="flex: 1;">
                                <h1 class="channel-title">${channel.name}</h1>
                                <p style="color: var(--gray); margin: 15px 0;">${channel.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
                                <div style="display: flex; gap: 30px; margin: 20px 0;">
                                    <div><strong>${channel.subscribers.length}</strong> –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</div>
                                    <div><strong>${channel.posts.length}</strong> –ø–æ—Å—Ç–æ–≤</div>
                                </div>
                                <div style="display: flex; gap: 15px;">
                                    ${channel.creator === currentUser.id ? `
                                        <button class="profile-btn primary" onclick="createChannelPost(${channel.id})">‚ûï –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç</button>
                                    ` : `
                                        <button class="profile-btn ${isSubscribed ? 'secondary' : 'primary'}" onclick="subscribeChannel(${channel.id})">
                                            ${isSubscribed ? '‚úì –í—ã –ø–æ–¥–ø–∏—Å–∞–Ω—ã' : '–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è'}
                                        </button>
                                    `}
                                    ${currentUser?.isAdmin ? `
                                        <button class="admin-btn delete" onclick="deleteChannel(${channel.id})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª</button>
                                    ` : ''}
                                </div>
                                <p style="margin-top: 15px; color: var(--gray);">–°–æ–∑–¥–∞—Ç–µ–ª—å: ${creator ? creator.name + ' ' + creator.surname : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</p>
                            </div>
                        </div>
                    </div>
                    <div class="channel-posts">
                        <h3 style="margin-bottom: 20px;">–ü–æ—Å—Ç—ã</h3>
                        ${channel.posts.length === 0 ? '<p style="color: var(--gray);">–ù–µ—Ç –ø–æ—Å—Ç–æ–≤</p>' : ''}
                        ${channel.posts.map(post => `
                            <div class="channel-post">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                                    <div class="avatar" style="width: 35px; height: 35px;">
                                        ${channel.avatar ? `<img src="${channel.avatar}">` : 'üì¢'}
                                    </div>
                                    <div>
                                        <strong>${channel.name}</strong>
                                        <div style="color: var(--gray); font-size: 11px;">${post.time}</div>
                                    </div>
                                </div>
                                <div>${post.text}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            document.getElementById('channelsPage').innerHTML = html;
        }

        function renderChannels() {
            let html = `
                <div style="background: white; border-radius: 15px; padding: 25px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h2>–ö–∞–Ω–∞–ª—ã</h2>
                        <button class="auth-btn" style="width: auto; padding: 10px 20px;" onclick="openModal('channelModal')">+ –°–æ–∑–¥–∞—Ç—å</button>
                    </div>
                    <div class="channels-grid" id="channelsGrid"></div>
                </div>
            `;
            document.getElementById('channelsPage').innerHTML = html;

            const grid = document.getElementById('channelsGrid');
            if (channels.length === 0) {
                grid.innerHTML = '<p style="text-align: center; padding: 50px; color: var(--gray);">–ù–µ—Ç –∫–∞–Ω–∞–ª–æ–≤</p>';
                return;
            }

            grid.innerHTML = channels.map(channel => {
                const isSubscribed = channel.subscribers.includes(currentUser.id);
                return `
                    <div class="channel-card" onclick="openChannel(${channel.id})">
                        <div class="channel-icon">${channel.avatar ? `<img src="${channel.avatar}" style="width: 100%; height: 100%; object-fit: cover;">` : 'üì¢'}</div>
                        <div class="channel-name">${channel.name}</div>
                        <div class="channel-stats">
                            <span>üë• ${channel.subscribers.length}</span>
                            <span>üìù ${channel.posts.length}</span>
                        </div>
                        <button class="channel-subscribe-btn ${isSubscribed ? 'subscribed' : ''}" onclick="event.stopPropagation(); subscribeChannel(${channel.id})">
                            ${isSubscribed ? '‚úì –í—ã –ø–æ–¥–ø–∏—Å–∞–Ω—ã' : '–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è'}
                        </button>
                    </div>
                `;
            }).join('');
        }

        // ========== –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ (–û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø) ==========
        function renderAdminPanel() {
            const adminDiv = document.getElementById('adminPanel');
            
            adminDiv.innerHTML = `
                <div class="admin-header">
                    <h2>‚ö° –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
                    <div>
                        ${currentUser.isMasterAdmin ? '<span class="admin-badge">MASTER ADMIN</span>' : '<span class="admin-badge">ADMIN</span>'}
                    </div>
                </div>

                <div class="admin-stats">
                    <div class="stat-card">
                        <div class="stat-number">${users.length}</div>
                        <div>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${posts.length}</div>
                        <div>–ü–æ—Å—Ç–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${communities.length}</div>
                        <div>–°–æ–æ–±—â–µ—Å—Ç–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${channels.length}</div>
                        <div>–ö–∞–Ω–∞–ª–æ–≤</div>
                    </div>
                </div>

                ${currentUser.isMasterAdmin ? `
                    <div class="admin-section">
                        <h3>üé´ –í—ã–¥–∞—á–∞ –∫–æ–¥–æ–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
                        <button class="modal-btn" onclick="openModal('adminCodeModal')">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
                    </div>
                ` : ''}

                <div class="admin-section">
                    <h3>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                                <th>Email</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${users.filter(u => !u.isMasterAdmin).map(user => `
                                <tr>
                                    <td>${user.id}</td>
                                    <td>
                                        ${user.name} ${user.surname}
                                        ${user.isAdmin ? '<span class="admin-badge-small">ADMIN</span>' : ''}
                                        ${user.isVerified ? '<span class="verified-badge-small">‚úì</span>' : ''}
                                    </td>
                                    <td>${user.email}</td>
                                    <td>${user.isPrivate ? 'üîí –ü—Ä–∏–≤–∞—Ç–Ω—ã–π' : 'üåê –ü—É–±–ª–∏—á–Ω—ã–π'}</td>
                                    <td>
                                        <button class="admin-btn ban" onclick="banUser(${user.id})">üö´ –ë–∞–Ω</button>
                                        <button class="admin-btn verify" onclick="verifyUser(${user.id})">
                                            ${user.isVerified ? '‚ùå –£–±—Ä–∞—Ç—å –≥–∞–ª–æ—á–∫—É' : '‚úì –î–∞—Ç—å –≥–∞–ª–æ—á–∫—É'}
                                        </button>
                                        ${currentUser.isMasterAdmin ? `
                                            ${user.isAdmin ? 
                                                `<button class="admin-btn" onclick="removeAdmin(${user.id})">üë§ –°–Ω—è—Ç—å –∞–¥–º–∏–Ω–∞</button>` :
                                                `<button class="admin-btn make-admin" onclick="makeAdmin(${user.id})">‚≠ê –°–¥–µ–ª–∞—Ç—å –∞–¥–º–∏–Ω–æ–º</button>`
                                            }
                                        ` : ''}
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>

                <div class="admin-section">
                    <h3>üì¢ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∫–ª–∞–º–æ–π</h3>
                    <button class="modal-btn" onclick="openAdModal()">‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ä–µ–∫–ª–∞–º—É</button>
                    <div style="margin-top: 20px;">
                        ${ads.length === 0 ? '<p style="color: var(--gray);">–†–µ–∫–ª–∞–º–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π –Ω–µ—Ç</p>' : ''}
                        ${ads.map(ad => `
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin-bottom: 10px; display: flex; align-items: center; gap: 15px;">
                                ${ad.image ? `<img src="${ad.image}" style="width: 50px; height: 50px; border-radius: 5px; object-fit: cover;">` : ''}
                                <div style="flex: 1;">
                                    <strong>${ad.title}</strong>
                                    <p style="color: var(--gray); font-size: 13px;">${ad.text}</p>
                                    ${ad.link ? `<a href="${ad.link}" target="_blank" style="color: var(--success);">–ü–µ—Ä–µ–π—Ç–∏</a>` : ''}
                                </div>
                                <div>
                                    <button class="admin-btn" onclick="editAd('${ad.id}')">‚úèÔ∏è</button>
                                    <button class="admin-btn ban" onclick="deleteAd('${ad.id}')">üóëÔ∏è</button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // ========== –ü–û–ò–°–ö ==========
        function searchGlobal(query) {
            const results = document.getElementById('searchResults');
            if (!query.trim()) {
                results.classList.remove('active');
                return;
            }

            query = query.toLowerCase();
            
            const foundUsers = users.filter(u => 
                u.id !== currentUser.id &&
                (u.name.toLowerCase().includes(query) ||
                 u.surname.toLowerCase().includes(query) ||
                 u.tag.toLowerCase().includes(query))
            ).slice(0, 5);

            const foundCommunities = communities.filter(c => 
                c.name.toLowerCase().includes(query)
            ).slice(0, 3);

            const foundChannels = channels.filter(c => 
                c.name.toLowerCase().includes(query)
            ).slice(0, 3);

            let html = '';

            if (foundUsers.length) {
                html += '<div class="search-category">üë§ –õ—é–¥–∏</div>';
                foundUsers.forEach(u => {
                    html += `
                        <div class="search-item" onclick="showUserProfile(${u.id}); document.getElementById('searchResults').classList.remove('active');">
                            <div class="avatar" style="width: 40px; height: 40px;">
                                ${u.avatar ? `<img src="${u.avatar}">` : (u.name[0] + u.surname[0]).toUpperCase()}
                            </div>
                            <div>
                                <strong>${u.name} ${u.surname}</strong>
                                ${u.isVerified ? '<span class="verified-badge-small">‚úì</span>' : ''}
                                <div style="color: var(--gray);">${u.tag}</div>
                            </div>
                        </div>
                    `;
                });
            }

            if (foundCommunities.length) {
                html += '<div class="search-category">üè¢ –°–æ–æ–±—â–µ—Å—Ç–≤–∞</div>';
                foundCommunities.forEach(c => {
                    html += `
                        <div class="search-item" onclick="openCommunity(${c.id}); document.getElementById('searchResults').classList.remove('active');">
                            <div class="avatar" style="width: 40px; height: 40px;">üè¢</div>
                            <div>
                                <strong>${c.name}</strong>
                                <div style="color: var(--gray);">üë• ${c.members.length} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
                            </div>
                        </div>
                    `;
                });
            }

            if (foundChannels.length) {
                html += '<div class="search-category">üì¢ –ö–∞–Ω–∞–ª—ã</div>';
                foundChannels.forEach(c => {
                    html += `
                        <div class="search-item" onclick="openChannel(${c.id}); document.getElementById('searchResults').classList.remove('active');">
                            <div class="avatar" style="width: 40px; height: 40px;">üì¢</div>
                            <div>
                                <strong>${c.name}</strong>
                                <div style="color: var(--gray);">üë• ${c.subscribers.length} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</div>
                            </div>
                        </div>
                    `;
                });
            }

            results.innerHTML = html || '<div style="padding: 30px; text-align: center; color: var(--gray);">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
            results.classList.add('active');
        }

        // ========== –ù–ê–í–ò–ì–ê–¶–ò–Ø ==========
        function showSocialPage() {
            document.getElementById('authPage').style.display = 'none';
            document.getElementById('socialPage').classList.add('active');
            
            if (currentUser?.isAdmin || currentUser?.isMasterAdmin) {
                document.getElementById('adminMenuItem').style.display = 'flex';
            }
        }

        function logout() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?')) {
                localStorage.removeItem('skrip_currentUser');
                currentUser = null;
                document.getElementById('authPage').style.display = 'flex';
                document.getElementById('socialPage').classList.remove('active');
            }
        }

        function hideAllPages() {
            ['feedContent', 'profilePage', 'friendsPage', 'messagesPage', 'communitiesPage', 'channelsPage', 'gamesPage', 'adminPage'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.style.display = 'none';
            });
            document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));
        }

        function showFeed() {
            hideAllPages();
            document.getElementById('feedContent').style.display = 'block';
            document.querySelector('.menu-item').classList.add('active');
            updateFeed();
            updateStories();
        }

        function showFriends() {
            hideAllPages();
            document.getElementById('friendsPage').style.display = 'block';
            document.querySelectorAll('.menu-item')[2].classList.add('active');
            renderFriends();
        }

        function showMessages() {
            hideAllPages();
            document.getElementById('messagesPage').style.display = 'block';
            document.querySelectorAll('.menu-item')[3].classList.add('active');
            updateChats();
        }

        function showCommunities() {
            hideAllPages();
            document.getElementById('communitiesPage').style.display = 'block';
            document.querySelectorAll('.menu-item')[4].classList.add('active');
            renderCommunities();
        }

        function showChannels() {
            hideAllPages();
            document.getElementById('channelsPage').style.display = 'block';
            document.querySelectorAll('.menu-item')[5].classList.add('active');
            renderChannels();
        }

        function showGames() {
            hideAllPages();
            document.getElementById('gamesPage').style.display = 'block';
            document.querySelectorAll('.menu-item')[6].classList.add('active');
        }

        function showAdminPanel() {
            if (!currentUser?.isAdmin && !currentUser?.isMasterAdmin) {
                alert('–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!');
                return;
            }
            hideAllPages();
            document.getElementById('adminPage').style.display = 'block';
            document.getElementById('adminMenuItem').classList.add('active');
            renderAdminPanel();
        }

        // ========== –û–ë–©–ò–ï –§–£–ù–ö–¶–ò–ò ==========
        function updateUI() {
            const initial = (currentUser.name[0] + currentUser.surname[0]).toUpperCase();
            document.getElementById('headerAvatar').innerHTML = currentUser.avatar ? `<img src="${currentUser.avatar}">` : initial;
            document.getElementById('postAvatar').innerHTML = currentUser.avatar ? `<img src="${currentUser.avatar}">` : initial;
            updateNotifications();
        }

        function viewImage(src) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.95);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 3000;
                cursor: pointer;
            `;
            modal.innerHTML = `<img src="${src}" style="max-width: 90%; max-height: 90%; border-radius: 10px;">`;
            modal.onclick = () => modal.remove();
            document.body.appendChild(modal);
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∏—Å–∫–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.search')) {
                document.getElementById('searchResults').classList.remove('active');
            }
        });

        init();
    </script>
</body>
</html>
